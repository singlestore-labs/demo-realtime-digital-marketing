var Ko=Object.defineProperty,$o=Object.defineProperties;var Jo=Object.getOwnPropertyDescriptors;var ee=Object.getOwnPropertySymbols;var Ze=Object.prototype.hasOwnProperty,Xe=Object.prototype.propertyIsEnumerable;var Te=(e,o,t)=>o in e?Ko(e,o,{enumerable:!0,configurable:!0,writable:!0,value:t}):e[o]=t,b=(e,o)=>{for(var t in o||(o={}))Ze.call(o,t)&&Te(e,t,o[t]);if(ee)for(var t of ee(o))Xe.call(o,t)&&Te(e,t,o[t]);return e},f=(e,o)=>$o(e,Jo(o));var L=(e,o)=>{var t={};for(var r in e)Ze.call(e,r)&&o.indexOf(r)<0&&(t[r]=e[r]);if(e!=null&&ee)for(var r of ee(e))o.indexOf(r)<0&&Xe.call(e,r)&&(t[r]=e[r]);return t};var _=(e,o,t)=>(Te(e,typeof o!="symbol"?o+"":o,t),t);import{j as c,F as xe,a as i,b as De,I as ro,c as Zo,q as Xo,L as U,E as Qo,N as io,R as qo,d as le,e as I,f as ao,g as et,h as R,S as ot,i as W,k as no,B as N,s as tt,_ as we,l as g,u as x,m as rt,r as u,n as lo,o as so,p as Pe,t as X,v as w,A as it,M as co,w as at,x as po,y as yo,z as uo,C as D,D as nt,G as dt,H as lt,J as re,K as ie,O as ae,P as st,Q as ue,T as ct,U as C,V as Re,W as Me,X as se,Y as Se,Z as pt,$ as yt,a0 as ce,a1 as ge,a2 as go,a3 as mo,a4 as me,a5 as ut,a6 as gt,a7 as mt,a8 as vt,a9 as bt,aa as ht,ab as Be,ac as P,ad as ft,ae as _t,af as Et,ag as Tt,ah as Qe,ai as St,aj as Nt,ak as Ue,al as wt,am as Oe,an as Rt,ao as Ot,ap as It,aq as At,ar as vo,as as G,at as Y,au as H,av as Lt,aw as pe,ax as bo,ay as kt,az as Ct,aA as qe,aB as zt,aC as xt,aD as Dt,aE as Pt,aF as Mt,aG as Bt,aH as Ut,aI as Ft}from"./vendor.c2578169.js";const Gt=function(){const o=document.createElement("link").relList;if(o&&o.supports&&o.supports("modulepreload"))return;for(const a of document.querySelectorAll('link[rel="modulepreload"]'))r(a);new MutationObserver(a=>{for(const n of a)if(n.type==="childList")for(const d of n.addedNodes)d.tagName==="LINK"&&d.rel==="modulepreload"&&r(d)}).observe(document,{childList:!0,subtree:!0});function t(a){const n={};return a.integrity&&(n.integrity=a.integrity),a.referrerpolicy&&(n.referrerPolicy=a.referrerpolicy),a.crossorigin==="use-credentials"?n.credentials="include":a.crossorigin==="anonymous"?n.credentials="omit":n.credentials="same-origin",n}function r(a){if(a.ep)return;a.ep=!0;const n=t(a);fetch(a.href,n)}};Gt();const oe=({label:e,placeholder:o,value:t,setValue:r,helpText:a,type:n="text"})=>c(xe,{children:[i(De,{mb:1,fontSize:"xs",fontWeight:"bold",textTransform:"uppercase",children:e}),i(ro,{size:"sm",placeholder:o,value:t,onChange:d=>r(d.target.value),type:n}),a?i(Zo,{fontSize:"xs",children:a}):null]}),Yt=Xo({a:t=>{var r=t,{children:e}=r,o=L(r,["children"]);const{href:a}=o,n=!!(a==null?void 0:a.startsWith("http"));return n?c(U,f(b({isExternal:n},o),{children:[e,i(Qo,{bottom:"2px",boxSize:"0.9em",position:"relative",ml:1})]})):i(U,f(b({to:a||""},o),{as:io,children:e}))}}),T=t=>{var r=t,{children:e}=r,o=L(r,["children"]);return i(qo,f(b({},o),{skipHtml:!0,components:Yt,children:Array.isArray(e)?e.filter(a=>a).map(a=>le(a||"")).join(`

`):le(e)}))},j=[{name:"s00",maxRows:1e7,prefix:"v2/100k-2p",partitions:2},{name:"s0",maxRows:2e7,prefix:"v2/100k-4p",partitions:4},{name:"s1-small",maxRows:4e7,prefix:"v2/100k-8p",partitions:8},{name:"s1",maxRows:8e7,prefix:"v2/1m-8p",partitions:8},{name:"s2",maxRows:16e7,prefix:"v2/1m-16p",partitions:16},{name:"s4",maxRows:32e7,prefix:"v2/1m-32p",partitions:16},{name:"s8",maxRows:64e7,prefix:"v2/1m-64p",partitions:64},{name:"s10",maxRows:1e9,prefix:"v2/10m-80p",partitions:80}],Ht=e=>j.find(o=>o.name===e)||j[0],V=({encode:e,decode:o}={encode:JSON.stringify,decode:JSON.parse})=>({setSelf:t,onSet:r,node:a})=>{const n=`recoil.localstorage.${a.key}`,d=localStorage.getItem(n);d!=null&&t(o(d)),r((s,l,p)=>{p?localStorage.removeItem(n):localStorage.setItem(n,e(s))})},Fe=()=>({setSelf:e,node:{key:o}})=>{const{location:t}=window;if(t){const r=new URLSearchParams(t.search);e(r.get(o))}},jt=I({key:"skipCreateDatabase",default:null,effects:[Fe()]}),Wt=I({key:"sessionId",default:null,effects:[Fe()]}),Vt=I({key:"vaporBaseUrl",default:"https://vapor.labs.singlestore.com",effects:[Fe()]}),ho=I({key:"connectionHost",default:"http://127.0.0.1",effects:[V()]}),fo=I({key:"connectionUser",default:"root",effects:[V()]}),_o=I({key:"connectionPassword",default:"",effects:[V()]}),Q=I({key:"connectionDatabase",default:"s2cellular",effects:[V()]}),Eo=ao({key:"vaporConnectionConfig",get:async({get:e})=>{const o=e(Wt),t=e(Vt);if(o)try{const r=await fetch(t+"/api/v1/vapor/connect?sessionId="+o);if(r.status===200){const a=await r.json();return{host:a.endpoint,user:a.user,password:a.password,database:e(Q)}}}catch{console.log(`Failed to connect to vapor at ${t}, falling back to local config`)}}}),E=ao({key:"connectionConfig",get:({get:e})=>{const o=e(Eo);if(o)return o;const t=e(ho),r=e(fo),a=e(_o),n=e(Q);return{host:t,user:r,password:a,database:n}},cachePolicy_UNSTABLE:{eviction:"most-recent"}}),K=I({key:"configScaleFactor",default:j[0],effects:[V({encode:e=>e.name,decode:e=>j.find(o=>o.name===e)||j[0]})]}),$=I({key:"simulatorEnabled",default:!0,effects:[V()]}),Kt=I({key:"databaseDrawerIsOpen",default:!1}),Ie=et({key:"tickDurationMs",default:void 0}),$t=()=>{const[e,o]=R(K);return c(xe,{children:[i(De,{mb:1,fontSize:"xs",fontWeight:"bold",textTransform:"uppercase",children:"Scale Factor"}),i(ot,{size:"sm",required:!0,value:e.name,onChange:t=>{const r=t.target.value;o(Ht(r))},children:j.map(t=>i("option",{value:t.name,children:t.name},t.name))})]})},To=({showDatabase:e,showScaleFactor:o})=>{const[t,r]=R(ho),[a,n]=R(fo),[d,s]=R(_o),[l,p]=R(Q);return c(W,{spacing:4,children:[i(oe,{label:"Host & Port",placeholder:"http://127.0.0.1:8808",value:t,setValue:r,helpText:i(T,{children:`
              The protocol (http, https), host, and port for the SingleStore
              [HTTP API][1].

              [1]: https://docs.singlestore.com/docs/http-api/
            `})}),c(no,{columns:2,gap:2,children:[i(oe,{label:"Username",placeholder:"admin",value:a,setValue:n}),i(oe,{label:"Password",placeholder:"",value:d,setValue:s,type:"password"}),e&&i(oe,{label:"Database",placeholder:"s2cellular",value:l,setValue:p}),o&&i($t,{})]})]})},So=e=>i(N,f(b({onClick:()=>{const{pathname:o,hash:t}=window.location;window.location.replace(o+t)},colorScheme:"red"},e),{children:"Disconnect"})),Jt=/^Error (?<code>\d+):/;class O extends Error{constructor(o,t,r){super(o);_(this,"code");_(this,"sql");var a;if(Object.setPrototypeOf(this,O.prototype),this.sql=t,r)this.code=r;else{const n=o.match(Jt);this.code=n?parseInt(((a=n.groups)==null?void 0:a.code)||"-1",10):-1}}isUnknownDatabase(){return this.code===1049}isDatabaseRecovering(){return this.code===2269}}const No=async(e,o,...t)=>{const r=await q(e,o,...t);if(r.length!==1)throw new O("Expected exactly one row",o);return r[0]},q=async(e,o,...t)=>{const r=await ve("query/rows",e,o,...t);if(r.results.length!==1)throw new O("Expected exactly one result set",o);return r.results[0].rows},wo=(e,o,...t)=>q(f(b({},e),{database:void 0}),o,...t),Ge=async(e,o,...t)=>{const r=await ve("query/tuples",e,o,...t);if(r.results.length!==1)throw new O("Expected exactly one result set",o);return r.results[0].rows},Ae=(e,o,...t)=>ve("exec",f(b({},e),{database:void 0}),o,...t),h=(e,o,...t)=>ve("exec",e,o,...t),ve=async(e,o,t,...r)=>{var d;const a=await fetch(`${o.host}/api/v1/${e}`,{method:"POST",signal:(d=o.ctx)==null?void 0:d.signal,headers:{"Content-Type":"application/json",Authorization:`Basic ${btoa(`${o.user}:${o.password}`)}`},body:JSON.stringify({sql:t,args:r,database:o.database})});if(!a.ok)throw new O(await a.text(),t);const n=await a.json();if(n.error)throw new O(n.error.message,t,n.error.code);return n};class Zt{constructor(o,t,r=!1){_(this,"tuples",[]);this.table=o,this.columns=t,this.replace=r}append(...o){if(o.length!==this.columns.length)throw new Error(`Expected ${this.columns.length} values, got ${o.length}`);this.tuples.push(o)}clear(){this.tuples=[]}sql(){const o=`(${this.columns.map(()=>"?").join(",")})`,t=this.tuples.map(()=>o).join(",");return le`
      ${this.replace?"REPLACE":"INSERT"} INTO ${this.table}
      (${this.columns.join(", ")})
      VALUES
        ${t}
    `}params(){return this.tuples.flat()}}class Ro extends Zt{constructor(o,t){super(o,t,!0)}}const Xt=e=>`POLYGON((${e.map(t=>`${t[0]} ${t[1]}`).join(",")}))`,Ye=e=>{const[o,t]=e.ne,[r,a]=e.sw;return Xt([[a,o],[t,o],[t,r],[a,r],[a,o]])},eo="POLYGON((",oo="))",Qt=e=>{if(e.startsWith(eo)&&e.endsWith(oo))return e.slice(eo.length,-oo.length).split(",").map(t=>{const[r,a]=t.trim().split(" ");return[parseFloat(r),parseFloat(a)]});throw new Error(`Invalid WKT polygon: ${e}`)};var qt=[{id:1,vendor:"Youspan",tld:"info",category:"sports",popularity:.37},{id:2,vendor:"Linkbridge",tld:"edu",category:"books",popularity:.6},{id:3,vendor:"Feedfire",tld:"gov",category:"sports",popularity:.55},{id:4,vendor:"Kimia",tld:"gov",category:"movies",popularity:.53},{id:5,vendor:"Zava",tld:"net",category:"kids",popularity:.39},{id:6,vendor:"Oyoyo",tld:"net",category:"jewelry",popularity:.21},{id:7,vendor:"Trunyx",tld:"edu",category:"outdoors",popularity:.72},{id:8,vendor:"Oyonder",tld:"org",category:"games",popularity:.38},{id:9,vendor:"Podcat",tld:"mil",category:"beauty",popularity:.2},{id:10,vendor:"Quatz",tld:"mil",category:"garden",popularity:.59},{id:11,vendor:"Thoughtsphere",tld:"biz",category:"home",popularity:.13},{id:12,vendor:"Twinte",tld:"biz",category:"clothing",popularity:.47},{id:13,vendor:"Blogtags",tld:"edu",category:"toys",popularity:.87},{id:14,vendor:"Oyonder",tld:"com",category:"garden",popularity:.54},{id:15,vendor:"Babbleblab",tld:"gov",category:"kids",popularity:.63},{id:16,vendor:"Realbridge",tld:"net",category:"music",popularity:.75},{id:17,vendor:"Einti",tld:"name",category:"shoes",popularity:.41},{id:18,vendor:"Vitz",tld:"edu",category:"sports",popularity:.36},{id:19,vendor:"Jabbercube",tld:"gov",category:"kids",popularity:.77},{id:20,vendor:"Kwimbee",tld:"net",category:"beauty",popularity:.36},{id:21,vendor:"Aibox",tld:"net",category:"toys",popularity:1.02},{id:22,vendor:"Wikibox",tld:"edu",category:"toys",popularity:.58},{id:23,vendor:"Devpoint",tld:"edu",category:"garden",popularity:.93},{id:24,vendor:"Latz",tld:"biz",category:"music",popularity:.2},{id:25,vendor:"Minyx",tld:"biz",category:"music",popularity:.76},{id:26,vendor:"Jetwire",tld:"edu",category:"toys",popularity:.54},{id:27,vendor:"Topicshots",tld:"info",category:"movies",popularity:.65},{id:28,vendor:"Zoomzone",tld:"gov",category:"outdoors",popularity:.73},{id:29,vendor:"Eare",tld:"gov",category:"tools",popularity:.57},{id:30,vendor:"Centidel",tld:"org",category:"grocery",popularity:.8},{id:31,vendor:"Fivebridge",tld:"info",category:"books",popularity:.69},{id:32,vendor:"Twitterbeat",tld:"mil",category:"jewelry",popularity:.54},{id:33,vendor:"Chatterbridge",tld:"com",category:"jewelry",popularity:.43},{id:34,vendor:"Edgepulse",tld:"edu",category:"jewelry",popularity:.44},{id:35,vendor:"Skyvu",tld:"org",category:"sports",popularity:1.02},{id:36,vendor:"Gevee",tld:"mil",category:"computers",popularity:.41},{id:37,vendor:"Kwinu",tld:"mil",category:"sports",popularity:.46},{id:38,vendor:"Quire",tld:"mil",category:"industrial",popularity:.47},{id:39,vendor:"Roombo",tld:"info",category:"tools",popularity:.45},{id:40,vendor:"Linkbuzz",tld:"net",category:"kids",popularity:.59},{id:41,vendor:"Photobug",tld:"net",category:"books",popularity:.84},{id:42,vendor:"Wikizz",tld:"info",category:"toys",popularity:.3},{id:43,vendor:"Ainyx",tld:"biz",category:"kids",popularity:.51},{id:44,vendor:"Mita",tld:"gov",category:"music",popularity:.8},{id:45,vendor:"Oloo",tld:"biz",category:"home",popularity:.62},{id:46,vendor:"Wikido",tld:"mil",category:"books",popularity:.33},{id:47,vendor:"Agivu",tld:"net",category:"industrial",popularity:.16},{id:48,vendor:"Jabberstorm",tld:"name",category:"toys",popularity:.34},{id:49,vendor:"Voonix",tld:"edu",category:"health",popularity:.67},{id:50,vendor:"Dabfeed",tld:"mil",category:"movies",popularity:.63},{id:51,vendor:"Camido",tld:"com",category:"games",popularity:.16},{id:52,vendor:"Yodel",tld:"com",category:"automotive",popularity:.71},{id:53,vendor:"Twitterbeat",tld:"net",category:"health",popularity:.77},{id:54,vendor:"Bubblemix",tld:"name",category:"clothing",popularity:.29},{id:55,vendor:"Eidel",tld:"com",category:"outdoors",popularity:.19},{id:56,vendor:"Devify",tld:"biz",category:"jewelry",popularity:.3},{id:57,vendor:"Pixope",tld:"net",category:"jewelry",popularity:.55},{id:58,vendor:"Twiyo",tld:"mil",category:"automotive",popularity:.59},{id:59,vendor:"Flashpoint",tld:"mil",category:"beauty",popularity:.83},{id:60,vendor:"Dynabox",tld:"biz",category:"automotive",popularity:.43},{id:61,vendor:"Browseblab",tld:"edu",category:"automotive",popularity:.64},{id:62,vendor:"Gabspot",tld:"mil",category:"shoes",popularity:.39},{id:63,vendor:"Edgetag",tld:"biz",category:"electronics",popularity:.78},{id:64,vendor:"Fatz",tld:"info",category:"music",popularity:.47},{id:65,vendor:"Tagfeed",tld:"info",category:"sports",popularity:.72},{id:66,vendor:"Aivee",tld:"gov",category:"games",popularity:-.01},{id:67,vendor:"Gabvine",tld:"net",category:"garden",popularity:.31},{id:68,vendor:"Thoughtstorm",tld:"biz",category:"health",popularity:.63},{id:69,vendor:"Rhynyx",tld:"info",category:"games",popularity:.3},{id:70,vendor:"Meezzy",tld:"biz",category:"shoes",popularity:.49},{id:71,vendor:"Jaloo",tld:"com",category:"home",popularity:.03},{id:72,vendor:"Ntags",tld:"info",category:"computers",popularity:.82},{id:73,vendor:"Meevee",tld:"info",category:"grocery",popularity:.09},{id:74,vendor:"Zoonder",tld:"org",category:"grocery",popularity:.8},{id:75,vendor:"Twitterworks",tld:"com",category:"computers",popularity:.18},{id:76,vendor:"Tagchat",tld:"biz",category:"toys",popularity:.41},{id:77,vendor:"Wordpedia",tld:"biz",category:"music",popularity:.72},{id:78,vendor:"Trilith",tld:"com",category:"shoes",popularity:.33},{id:79,vendor:"Oyonder",tld:"com",category:"music",popularity:.67},{id:80,vendor:"Abata",tld:"net",category:"games",popularity:.39},{id:81,vendor:"BlogXS",tld:"gov",category:"movies",popularity:.31},{id:82,vendor:"Oba",tld:"info",category:"health",popularity:.18},{id:83,vendor:"Edgewire",tld:"name",category:"beauty",popularity:.32},{id:84,vendor:"Ainyx",tld:"gov",category:"baby",popularity:.19},{id:85,vendor:"Riffpedia",tld:"gov",category:"grocery",popularity:.23},{id:86,vendor:"Fadeo",tld:"gov",category:"movies",popularity:.27},{id:87,vendor:"Muxo",tld:"name",category:"grocery",popularity:.15},{id:88,vendor:"Skaboo",tld:"org",category:"sports",popularity:.18},{id:89,vendor:"Babbleopia",tld:"gov",category:"automotive",popularity:.6},{id:90,vendor:"Meedoo",tld:"gov",category:"sports",popularity:.81},{id:91,vendor:"Dabshots",tld:"name",category:"home",popularity:.65},{id:92,vendor:"Aimbo",tld:"mil",category:"baby",popularity:.55},{id:93,vendor:"Jaloo",tld:"gov",category:"jewelry",popularity:.83},{id:94,vendor:"Browsezoom",tld:"org",category:"beauty",popularity:.66},{id:95,vendor:"Browsedrive",tld:"org",category:"beauty",popularity:.56},{id:96,vendor:"Jazzy",tld:"gov",category:"automotive",popularity:.85},{id:97,vendor:"Meetz",tld:"info",category:"movies",popularity:.71},{id:98,vendor:"Trudeo",tld:"edu",category:"movies",popularity:.98},{id:99,vendor:"Skimia",tld:"com",category:"industrial",popularity:.77},{id:100,vendor:"Skiba",tld:"com",category:"music",popularity:.93},{id:101,vendor:"Babblestorm",tld:"name",category:"industrial",popularity:1.18},{id:102,vendor:"Voomm",tld:"name",category:"computers",popularity:.08},{id:103,vendor:"Roombo",tld:"edu",category:"garden",popularity:1.16},{id:104,vendor:"Twimm",tld:"info",category:"baby",popularity:.96},{id:105,vendor:"Bluejam",tld:"edu",category:"health",popularity:.48},{id:106,vendor:"Twitterwire",tld:"org",category:"garden",popularity:.62},{id:107,vendor:"Ainyx",tld:"name",category:"toys",popularity:.5},{id:108,vendor:"Livetube",tld:"net",category:"automotive",popularity:.4},{id:109,vendor:"Eidel",tld:"gov",category:"baby",popularity:.48},{id:110,vendor:"Realmix",tld:"edu",category:"kids",popularity:.7},{id:111,vendor:"Zoonoodle",tld:"mil",category:"automotive",popularity:.77},{id:112,vendor:"Omba",tld:"biz",category:"jewelry",popularity:.48},{id:113,vendor:"Brightdog",tld:"name",category:"automotive",popularity:.39},{id:114,vendor:"Brainlounge",tld:"info",category:"baby",popularity:.8},{id:115,vendor:"Shufflester",tld:"mil",category:"music",popularity:.49},{id:116,vendor:"Fivebridge",tld:"com",category:"industrial",popularity:.54},{id:117,vendor:"Topicshots",tld:"biz",category:"toys",popularity:.55},{id:118,vendor:"Photobug",tld:"mil",category:"outdoors",popularity:.4},{id:119,vendor:"Skippad",tld:"biz",category:"computers",popularity:.2},{id:120,vendor:"Dabshots",tld:"mil",category:"shoes",popularity:.47},{id:121,vendor:"Aimbo",tld:"mil",category:"jewelry",popularity:.61},{id:122,vendor:"Oyope",tld:"biz",category:"electronics",popularity:.53},{id:123,vendor:"Kimia",tld:"org",category:"tools",popularity:.53},{id:124,vendor:"Avaveo",tld:"biz",category:"garden",popularity:.37},{id:125,vendor:"Kwideo",tld:"biz",category:"kids",popularity:.02},{id:126,vendor:"Voomm",tld:"com",category:"movies",popularity:.3},{id:127,vendor:"Voolia",tld:"com",category:"outdoors",popularity:.8},{id:128,vendor:"Layo",tld:"gov",category:"books",popularity:.17},{id:129,vendor:"Trilia",tld:"com",category:"games",popularity:.13},{id:130,vendor:"Zazio",tld:"edu",category:"clothing",popularity:.34},{id:131,vendor:"Topdrive",tld:"gov",category:"industrial",popularity:.53},{id:132,vendor:"Yoveo",tld:"info",category:"computers",popularity:.63},{id:133,vendor:"Yodel",tld:"info",category:"electronics",popularity:.4},{id:134,vendor:"Dynabox",tld:"org",category:"industrial",popularity:.02},{id:135,vendor:"Browsebug",tld:"info",category:"toys",popularity:.65},{id:136,vendor:"Riffpath",tld:"mil",category:"jewelry",popularity:.46},{id:137,vendor:"Jaloo",tld:"name",category:"baby",popularity:.62},{id:138,vendor:"Linklinks",tld:"mil",category:"health",popularity:.33},{id:139,vendor:"Yotz",tld:"biz",category:"industrial",popularity:.88},{id:140,vendor:"Mymm",tld:"org",category:"computers",popularity:.64},{id:141,vendor:"Ailane",tld:"biz",category:"automotive",popularity:.67},{id:142,vendor:"Realmix",tld:"org",category:"kids",popularity:.45},{id:143,vendor:"Pixonyx",tld:"edu",category:"automotive",popularity:.23},{id:144,vendor:"Talane",tld:"com",category:"grocery",popularity:.29},{id:145,vendor:"Jabberbean",tld:"info",category:"industrial",popularity:.38},{id:146,vendor:"Wikido",tld:"mil",category:"clothing",popularity:.93},{id:147,vendor:"InnoZ",tld:"info",category:"automotive",popularity:.76},{id:148,vendor:"Photobug",tld:"org",category:"toys",popularity:.63},{id:149,vendor:"Dazzlesphere",tld:"mil",category:"toys",popularity:.38},{id:150,vendor:"Trudoo",tld:"net",category:"music",popularity:.41},{id:151,vendor:"Photolist",tld:"edu",category:"health",popularity:.56},{id:152,vendor:"Twinte",tld:"gov",category:"clothing",popularity:.76},{id:153,vendor:"Buzzbean",tld:"org",category:"movies",popularity:.57},{id:154,vendor:"Demivee",tld:"net",category:"home",popularity:.08},{id:155,vendor:"Photojam",tld:"edu",category:"movies",popularity:.86},{id:156,vendor:"Flipstorm",tld:"info",category:"tools",popularity:.5},{id:157,vendor:"Muxo",tld:"edu",category:"garden",popularity:.66},{id:158,vendor:"Dabjam",tld:"mil",category:"kids",popularity:.75},{id:159,vendor:"Vimbo",tld:"edu",category:"electronics",popularity:.34},{id:160,vendor:"Yakidoo",tld:"name",category:"books",popularity:.76},{id:161,vendor:"Tagfeed",tld:"com",category:"sports",popularity:.21},{id:162,vendor:"Twimm",tld:"org",category:"sports",popularity:.65},{id:163,vendor:"Pixonyx",tld:"org",category:"garden",popularity:.44},{id:164,vendor:"Twimm",tld:"org",category:"beauty",popularity:.52},{id:165,vendor:"Camimbo",tld:"org",category:"home",popularity:.67},{id:166,vendor:"Pixope",tld:"org",category:"clothing",popularity:.55},{id:167,vendor:"Camimbo",tld:"gov",category:"kids",popularity:.62},{id:168,vendor:"Teklist",tld:"name",category:"games",popularity:.81},{id:169,vendor:"Meeveo",tld:"com",category:"movies",popularity:.64},{id:170,vendor:"Kwimbee",tld:"edu",category:"books",popularity:.69},{id:171,vendor:"Jabbersphere",tld:"com",category:"shoes",popularity:.43},{id:172,vendor:"Kwilith",tld:"gov",category:"computers",popularity:.7},{id:173,vendor:"Livetube",tld:"mil",category:"games",popularity:.34},{id:174,vendor:"Izio",tld:"gov",category:"tools",popularity:.56},{id:175,vendor:"Jatri",tld:"org",category:"baby",popularity:.87},{id:176,vendor:"Trupe",tld:"info",category:"sports",popularity:.24},{id:177,vendor:"Rhyloo",tld:"biz",category:"games",popularity:.62},{id:178,vendor:"Rhynyx",tld:"mil",category:"sports",popularity:.63},{id:179,vendor:"Teklist",tld:"org",category:"tools",popularity:.86},{id:180,vendor:"Skibox",tld:"com",category:"kids",popularity:.31},{id:181,vendor:"Gigashots",tld:"gov",category:"outdoors",popularity:.06},{id:182,vendor:"Tambee",tld:"edu",category:"baby",popularity:.55},{id:183,vendor:"Kwideo",tld:"mil",category:"outdoors",popularity:.82},{id:184,vendor:"Zoovu",tld:"mil",category:"games",popularity:.61},{id:185,vendor:"InnoZ",tld:"biz",category:"beauty",popularity:.61},{id:186,vendor:"Tagfeed",tld:"mil",category:"outdoors",popularity:.62},{id:187,vendor:"Eazzy",tld:"net",category:"beauty",popularity:.42},{id:188,vendor:"Meejo",tld:"com",category:"outdoors",popularity:.33},{id:189,vendor:"Centizu",tld:"biz",category:"kids",popularity:.83},{id:190,vendor:"Browsedrive",tld:"net",category:"automotive",popularity:.61},{id:191,vendor:"Zoomzone",tld:"mil",category:"books",popularity:.74},{id:192,vendor:"Riffwire",tld:"edu",category:"jewelry",popularity:.13},{id:193,vendor:"Vinte",tld:"mil",category:"games",popularity:.7},{id:194,vendor:"Browsezoom",tld:"info",category:"automotive",popularity:.02},{id:195,vendor:"Gabvine",tld:"info",category:"tools",popularity:.46},{id:196,vendor:"Linkbridge",tld:"mil",category:"kids",popularity:.79},{id:197,vendor:"Riffpedia",tld:"info",category:"grocery",popularity:.62},{id:198,vendor:"Zoombox",tld:"net",category:"industrial",popularity:-.09},{id:199,vendor:"Skiba",tld:"info",category:"jewelry",popularity:.82},{id:200,vendor:"Flashdog",tld:"biz",category:"games",popularity:.86},{id:201,vendor:"Rhyloo",tld:"name",category:"movies",popularity:.28},{id:202,vendor:"Yata",tld:"name",category:"sports",popularity:.74},{id:203,vendor:"Yakitri",tld:"info",category:"electronics",popularity:.33},{id:204,vendor:"Jetwire",tld:"biz",category:"computers",popularity:.67},{id:205,vendor:"Wordtune",tld:"org",category:"automotive",popularity:-.13},{id:206,vendor:"Zoombox",tld:"net",category:"garden",popularity:1.23},{id:207,vendor:"Photojam",tld:"com",category:"electronics",popularity:.52},{id:208,vendor:"Youspan",tld:"biz",category:"jewelry",popularity:.96},{id:209,vendor:"Twiyo",tld:"net",category:"grocery",popularity:.71},{id:210,vendor:"Reallinks",tld:"gov",category:"grocery",popularity:.85},{id:211,vendor:"Mycat",tld:"com",category:"music",popularity:.8},{id:212,vendor:"Jayo",tld:"edu",category:"computers",popularity:.43},{id:213,vendor:"Aivee",tld:"mil",category:"computers",popularity:.27},{id:214,vendor:"Eadel",tld:"biz",category:"movies",popularity:.64},{id:215,vendor:"Jabberstorm",tld:"net",category:"garden",popularity:.14},{id:216,vendor:"Oyope",tld:"gov",category:"computers",popularity:.97},{id:217,vendor:"Eabox",tld:"biz",category:"computers",popularity:.68},{id:218,vendor:"Edgeify",tld:"org",category:"home",popularity:.39},{id:219,vendor:"Jaxbean",tld:"edu",category:"automotive",popularity:.15},{id:220,vendor:"Topicblab",tld:"name",category:"books",popularity:.72},{id:221,vendor:"Vinder",tld:"org",category:"electronics",popularity:.51},{id:222,vendor:"Quimm",tld:"biz",category:"sports",popularity:.71},{id:223,vendor:"Thoughtstorm",tld:"mil",category:"beauty",popularity:.61},{id:224,vendor:"Browsedrive",tld:"edu",category:"shoes",popularity:.72},{id:225,vendor:"Mydo",tld:"name",category:"sports",popularity:.16},{id:226,vendor:"Gabcube",tld:"net",category:"beauty",popularity:.15},{id:227,vendor:"Rhynyx",tld:"name",category:"electronics",popularity:.55},{id:228,vendor:"Centizu",tld:"gov",category:"computers",popularity:.55},{id:229,vendor:"Quatz",tld:"biz",category:"outdoors",popularity:.91},{id:230,vendor:"Twitterwire",tld:"biz",category:"sports",popularity:.05},{id:231,vendor:"Oyonder",tld:"info",category:"garden",popularity:.43},{id:232,vendor:"Rhybox",tld:"gov",category:"jewelry",popularity:.19},{id:233,vendor:"Yacero",tld:"name",category:"sports",popularity:.67},{id:234,vendor:"Skyvu",tld:"org",category:"garden",popularity:.41},{id:235,vendor:"Dabvine",tld:"mil",category:"computers",popularity:.57},{id:236,vendor:"Brainverse",tld:"biz",category:"electronics",popularity:.97},{id:237,vendor:"Linkbridge",tld:"gov",category:"tools",popularity:.69},{id:238,vendor:"Ozu",tld:"net",category:"games",popularity:.7},{id:239,vendor:"Photobug",tld:"edu",category:"sports",popularity:.47},{id:240,vendor:"Gabtype",tld:"mil",category:"tools",popularity:.58},{id:241,vendor:"Tagcat",tld:"mil",category:"kids",popularity:.56},{id:242,vendor:"Centizu",tld:"info",category:"sports",popularity:.96},{id:243,vendor:"Babbleblab",tld:"com",category:"books",popularity:.76},{id:244,vendor:"Twitternation",tld:"biz",category:"jewelry",popularity:-.09},{id:245,vendor:"Jabbersphere",tld:"info",category:"outdoors",popularity:.44},{id:246,vendor:"Eabox",tld:"edu",category:"baby",popularity:.54},{id:247,vendor:"Oyonder",tld:"biz",category:"garden",popularity:.23},{id:248,vendor:"Eamia",tld:"biz",category:"tools",popularity:.63},{id:249,vendor:"Dabtype",tld:"mil",category:"jewelry",popularity:.55},{id:250,vendor:"Skyvu",tld:"edu",category:"movies",popularity:.55},{id:251,vendor:"Devshare",tld:"net",category:"computers",popularity:.71},{id:252,vendor:"Voolia",tld:"biz",category:"tools",popularity:.36},{id:253,vendor:"Camido",tld:"net",category:"health",popularity:.62},{id:254,vendor:"Wikizz",tld:"info",category:"industrial",popularity:.63},{id:255,vendor:"Youopia",tld:"gov",category:"kids",popularity:.42},{id:256,vendor:"Buzzdog",tld:"mil",category:"toys",popularity:.48},{id:257,vendor:"Livetube",tld:"info",category:"electronics",popularity:.06},{id:258,vendor:"Lazzy",tld:"gov",category:"shoes",popularity:.25},{id:259,vendor:"Dynabox",tld:"info",category:"electronics",popularity:.62},{id:260,vendor:"Livetube",tld:"biz",category:"games",popularity:.48},{id:261,vendor:"Eare",tld:"com",category:"industrial",popularity:.48},{id:262,vendor:"Skimia",tld:"com",category:"jewelry",popularity:.25},{id:263,vendor:"Dabtype",tld:"name",category:"books",popularity:.65},{id:264,vendor:"Avavee",tld:"info",category:"automotive",popularity:.61},{id:265,vendor:"Jabbertype",tld:"org",category:"automotive",popularity:.62},{id:266,vendor:"Zoombox",tld:"mil",category:"grocery",popularity:.97},{id:267,vendor:"Youspan",tld:"info",category:"movies",popularity:.33},{id:268,vendor:"Feedspan",tld:"mil",category:"outdoors",popularity:.88},{id:269,vendor:"Oyope",tld:"biz",category:"sports",popularity:.71},{id:270,vendor:"Feedfish",tld:"name",category:"home",popularity:.8},{id:271,vendor:"Linktype",tld:"info",category:"tools",popularity:.12},{id:272,vendor:"Centizu",tld:"net",category:"electronics",popularity:.28},{id:273,vendor:"Fivespan",tld:"info",category:"automotive",popularity:.52},{id:274,vendor:"Chatterpoint",tld:"org",category:"toys",popularity:.5},{id:275,vendor:"Fivebridge",tld:"com",category:"industrial",popularity:-.12},{id:276,vendor:"Quatz",tld:"com",category:"sports",popularity:.47},{id:277,vendor:"Eimbee",tld:"gov",category:"automotive",popularity:.53},{id:278,vendor:"Yotz",tld:"info",category:"movies",popularity:.78},{id:279,vendor:"Meevee",tld:"mil",category:"computers",popularity:.53},{id:280,vendor:"Kwideo",tld:"biz",category:"industrial",popularity:.58},{id:281,vendor:"Viva",tld:"name",category:"movies",popularity:.39},{id:282,vendor:"Thoughtworks",tld:"biz",category:"sports",popularity:.66},{id:283,vendor:"Plambee",tld:"net",category:"computers",popularity:-.02},{id:284,vendor:"Gabtune",tld:"gov",category:"beauty",popularity:.64},{id:285,vendor:"Eimbee",tld:"org",category:"jewelry",popularity:.32},{id:286,vendor:"Fiveclub",tld:"info",category:"games",popularity:.79},{id:287,vendor:"Vimbo",tld:"name",category:"garden",popularity:.63},{id:288,vendor:"Flashset",tld:"edu",category:"games",popularity:.53},{id:289,vendor:"Meeveo",tld:"name",category:"health",popularity:.4},{id:290,vendor:"Thoughtbridge",tld:"biz",category:"clothing",popularity:.22},{id:291,vendor:"Youspan",tld:"mil",category:"electronics",popularity:.34},{id:292,vendor:"Meembee",tld:"org",category:"beauty",popularity:.28},{id:293,vendor:"Zooveo",tld:"info",category:"games",popularity:.45},{id:294,vendor:"Feedbug",tld:"edu",category:"games",popularity:.6},{id:295,vendor:"Npath",tld:"org",category:"garden",popularity:.34},{id:296,vendor:"Jazzy",tld:"com",category:"grocery",popularity:.86},{id:297,vendor:"Kimia",tld:"biz",category:"games",popularity:.44},{id:298,vendor:"Ooba",tld:"com",category:"kids",popularity:.5},{id:299,vendor:"Gabspot",tld:"gov",category:"industrial",popularity:.42},{id:300,vendor:"Realcube",tld:"name",category:"beauty",popularity:.66},{id:301,vendor:"Yambee",tld:"net",category:"toys",popularity:.67},{id:302,vendor:"Realcube",tld:"biz",category:"outdoors",popularity:.41},{id:303,vendor:"Youfeed",tld:"mil",category:"health",popularity:.34},{id:304,vendor:"Eabox",tld:"com",category:"toys",popularity:.31},{id:305,vendor:"Riffpath",tld:"biz",category:"computers",popularity:.73},{id:306,vendor:"Ainyx",tld:"info",category:"sports",popularity:.75},{id:307,vendor:"Feedmix",tld:"biz",category:"health",popularity:.41},{id:308,vendor:"Eare",tld:"edu",category:"toys",popularity:.86},{id:309,vendor:"Vinder",tld:"info",category:"beauty",popularity:.55},{id:310,vendor:"Roombo",tld:"biz",category:"industrial",popularity:1},{id:311,vendor:"Dynazzy",tld:"name",category:"shoes",popularity:.43},{id:312,vendor:"Zoomzone",tld:"biz",category:"sports",popularity:.46},{id:313,vendor:"Voolia",tld:"name",category:"movies",popularity:.74},{id:314,vendor:"Ntag",tld:"mil",category:"sports",popularity:.34},{id:315,vendor:"Quinu",tld:"net",category:"home",popularity:.43},{id:316,vendor:"Jabbertype",tld:"info",category:"industrial",popularity:.54},{id:317,vendor:"Jatri",tld:"info",category:"clothing",popularity:.53},{id:318,vendor:"Feedbug",tld:"net",category:"grocery",popularity:.36},{id:319,vendor:"Babbleblab",tld:"net",category:"computers",popularity:1.05},{id:320,vendor:"Twiyo",tld:"org",category:"industrial",popularity:.79},{id:321,vendor:"Avamm",tld:"info",category:"kids",popularity:.29},{id:322,vendor:"Skippad",tld:"edu",category:"books",popularity:.23},{id:323,vendor:"Thoughtstorm",tld:"net",category:"movies",popularity:.45},{id:324,vendor:"Browseblab",tld:"gov",category:"jewelry",popularity:.77},{id:325,vendor:"Fliptune",tld:"name",category:"toys",popularity:.68},{id:326,vendor:"Twitterwire",tld:"mil",category:"sports",popularity:.8},{id:327,vendor:"Skippad",tld:"org",category:"games",popularity:.48},{id:328,vendor:"Lazzy",tld:"name",category:"electronics",popularity:.59},{id:329,vendor:"Zava",tld:"mil",category:"kids",popularity:.25},{id:330,vendor:"Linktype",tld:"org",category:"games",popularity:.81},{id:331,vendor:"Dabjam",tld:"net",category:"beauty",popularity:.78},{id:332,vendor:"Kare",tld:"org",category:"clothing",popularity:.23},{id:333,vendor:"Bubblebox",tld:"name",category:"beauty",popularity:.57},{id:334,vendor:"Gevee",tld:"net",category:"automotive",popularity:.34},{id:335,vendor:"Oyoyo",tld:"gov",category:"books",popularity:.55},{id:336,vendor:"Katz",tld:"gov",category:"outdoors",popularity:.25},{id:337,vendor:"Livepath",tld:"com",category:"games",popularity:.53},{id:338,vendor:"Ooba",tld:"org",category:"clothing",popularity:.23},{id:339,vendor:"Brightbean",tld:"edu",category:"automotive",popularity:.26},{id:340,vendor:"Skiba",tld:"net",category:"jewelry",popularity:.35},{id:341,vendor:"Feedfish",tld:"name",category:"outdoors",popularity:.08},{id:342,vendor:"Avamba",tld:"name",category:"sports",popularity:.41},{id:343,vendor:"Oba",tld:"com",category:"outdoors",popularity:.75},{id:344,vendor:"Zoombox",tld:"gov",category:"jewelry",popularity:.53},{id:345,vendor:"Fliptune",tld:"info",category:"electronics",popularity:.14},{id:346,vendor:"Brainbox",tld:"biz",category:"clothing",popularity:.21},{id:347,vendor:"Avamm",tld:"name",category:"baby",popularity:.46},{id:348,vendor:"Yozio",tld:"org",category:"toys",popularity:.63},{id:349,vendor:"Photobug",tld:"edu",category:"baby",popularity:.52},{id:350,vendor:"Demivee",tld:"gov",category:"clothing",popularity:.72},{id:351,vendor:"Brainlounge",tld:"org",category:"books",popularity:.45},{id:352,vendor:"Dazzlesphere",tld:"biz",category:"beauty",popularity:.75},{id:353,vendor:"Dazzlesphere",tld:"org",category:"games",popularity:.3},{id:354,vendor:"Aibox",tld:"biz",category:"home",popularity:.08},{id:355,vendor:"Feedspan",tld:"com",category:"home",popularity:.59},{id:356,vendor:"Camido",tld:"org",category:"outdoors",popularity:.24},{id:357,vendor:"Kare",tld:"net",category:"music",popularity:.41},{id:358,vendor:"Photolist",tld:"info",category:"shoes",popularity:.51},{id:359,vendor:"Photobug",tld:"net",category:"toys",popularity:.52},{id:360,vendor:"Centidel",tld:"net",category:"shoes",popularity:.66},{id:361,vendor:"Yabox",tld:"info",category:"outdoors",popularity:.32},{id:362,vendor:"Lajo",tld:"mil",category:"grocery",popularity:.59},{id:363,vendor:"Tagopia",tld:"net",category:"tools",popularity:.42},{id:364,vendor:"Brainlounge",tld:"gov",category:"outdoors",popularity:.49},{id:365,vendor:"Brainverse",tld:"org",category:"kids",popularity:.54},{id:366,vendor:"Kazio",tld:"edu",category:"books",popularity:.44},{id:367,vendor:"Thoughtbeat",tld:"mil",category:"music",popularity:.57},{id:368,vendor:"Yakidoo",tld:"org",category:"tools",popularity:.57},{id:369,vendor:"Skiptube",tld:"net",category:"jewelry",popularity:.41},{id:370,vendor:"Buzzshare",tld:"edu",category:"games",popularity:-.1},{id:371,vendor:"Brainbox",tld:"com",category:"industrial",popularity:.72},{id:372,vendor:"Talane",tld:"biz",category:"games",popularity:.7},{id:373,vendor:"Skyndu",tld:"com",category:"tools",popularity:.94},{id:374,vendor:"Jetwire",tld:"mil",category:"music",popularity:.02},{id:375,vendor:"Dazzlesphere",tld:"edu",category:"toys",popularity:.41},{id:376,vendor:"Rhynyx",tld:"gov",category:"beauty",popularity:.46},{id:377,vendor:"Kanoodle",tld:"biz",category:"shoes",popularity:.24},{id:378,vendor:"Jaxnation",tld:"org",category:"computers",popularity:.45},{id:379,vendor:"Photobug",tld:"gov",category:"outdoors",popularity:.32},{id:380,vendor:"Midel",tld:"info",category:"health",popularity:.86},{id:381,vendor:"Linktype",tld:"info",category:"tools",popularity:.7},{id:382,vendor:"Dabshots",tld:"mil",category:"industrial",popularity:.95},{id:383,vendor:"Zooveo",tld:"org",category:"beauty",popularity:.42},{id:384,vendor:"Blognation",tld:"mil",category:"jewelry",popularity:.26},{id:385,vendor:"Oyonder",tld:"name",category:"games",popularity:.97},{id:386,vendor:"Zoozzy",tld:"mil",category:"baby",popularity:.5},{id:387,vendor:"Skyble",tld:"edu",category:"shoes",popularity:.58},{id:388,vendor:"Zoomdog",tld:"name",category:"beauty",popularity:1.13},{id:389,vendor:"Buzzster",tld:"org",category:"industrial",popularity:.58},{id:390,vendor:"Bluezoom",tld:"gov",category:"books",popularity:.53},{id:391,vendor:"Skipfire",tld:"name",category:"kids",popularity:.35},{id:392,vendor:"InnoZ",tld:"org",category:"garden",popularity:.36},{id:393,vendor:"Youspan",tld:"edu",category:"garden",popularity:.12},{id:394,vendor:"Gabspot",tld:"net",category:"music",popularity:.68},{id:395,vendor:"Gabvine",tld:"edu",category:"home",popularity:.36},{id:396,vendor:"Flashspan",tld:"edu",category:"tools",popularity:.94},{id:397,vendor:"BlogXS",tld:"info",category:"grocery",popularity:.63},{id:398,vendor:"Tazzy",tld:"edu",category:"shoes",popularity:.57},{id:399,vendor:"Photofeed",tld:"mil",category:"clothing",popularity:.18},{id:400,vendor:"Agimba",tld:"biz",category:"grocery",popularity:.14},{id:401,vendor:"Jabberbean",tld:"biz",category:"kids",popularity:.49},{id:402,vendor:"Camimbo",tld:"mil",category:"sports",popularity:.28},{id:403,vendor:"Twitterwire",tld:"gov",category:"books",popularity:.58},{id:404,vendor:"Shuffledrive",tld:"gov",category:"garden",popularity:.95},{id:405,vendor:"Eayo",tld:"info",category:"tools",popularity:.44},{id:406,vendor:"Zoomzone",tld:"info",category:"toys",popularity:.46},{id:407,vendor:"Tagcat",tld:"gov",category:"electronics",popularity:0},{id:408,vendor:"Blogtags",tld:"biz",category:"home",popularity:.49},{id:409,vendor:"Jabbertype",tld:"com",category:"computers",popularity:.74},{id:410,vendor:"Photobug",tld:"info",category:"grocery",popularity:.75},{id:411,vendor:"Livepath",tld:"net",category:"beauty",popularity:1.03},{id:412,vendor:"Shufflebeat",tld:"net",category:"tools",popularity:.62},{id:413,vendor:"Skynoodle",tld:"biz",category:"clothing",popularity:.14},{id:414,vendor:"Youfeed",tld:"name",category:"shoes",popularity:.23},{id:415,vendor:"Gigaclub",tld:"net",category:"outdoors",popularity:.74},{id:416,vendor:"Twitterwire",tld:"info",category:"games",popularity:.93},{id:417,vendor:"Livefish",tld:"edu",category:"garden",popularity:.85},{id:418,vendor:"Dazzlesphere",tld:"mil",category:"beauty",popularity:.63},{id:419,vendor:"Quatz",tld:"edu",category:"toys",popularity:.35},{id:420,vendor:"Meezzy",tld:"biz",category:"kids",popularity:.37},{id:421,vendor:"Eidel",tld:"com",category:"movies",popularity:.61},{id:422,vendor:"DabZ",tld:"edu",category:"kids",popularity:.17},{id:423,vendor:"DabZ",tld:"mil",category:"beauty",popularity:.32},{id:424,vendor:"Twitterbridge",tld:"net",category:"tools",popularity:.29},{id:425,vendor:"Brainsphere",tld:"name",category:"books",popularity:.53},{id:426,vendor:"Realmix",tld:"gov",category:"baby",popularity:.74},{id:427,vendor:"Yodo",tld:"gov",category:"movies",popularity:.82},{id:428,vendor:"Realpoint",tld:"net",category:"toys",popularity:.33},{id:429,vendor:"Jamia",tld:"net",category:"music",popularity:.46},{id:430,vendor:"Skaboo",tld:"biz",category:"books",popularity:.17},{id:431,vendor:"LiveZ",tld:"edu",category:"baby",popularity:.52},{id:432,vendor:"Realbuzz",tld:"biz",category:"grocery",popularity:.55},{id:433,vendor:"Jetpulse",tld:"com",category:"sports",popularity:.17},{id:434,vendor:"Fivebridge",tld:"net",category:"shoes",popularity:.8},{id:435,vendor:"Talane",tld:"name",category:"jewelry",popularity:.58},{id:436,vendor:"Cogibox",tld:"com",category:"grocery",popularity:.09},{id:437,vendor:"Kwideo",tld:"edu",category:"shoes",popularity:.26},{id:438,vendor:"Avaveo",tld:"org",category:"electronics",popularity:.4},{id:439,vendor:"Brightbean",tld:"info",category:"baby",popularity:.92},{id:440,vendor:"Dablist",tld:"com",category:"beauty",popularity:.66},{id:441,vendor:"Voomm",tld:"org",category:"shoes",popularity:.59},{id:442,vendor:"Edgeblab",tld:"name",category:"electronics",popularity:.23},{id:443,vendor:"Gigazoom",tld:"edu",category:"electronics",popularity:.28},{id:444,vendor:"Riffpath",tld:"net",category:"shoes",popularity:.2},{id:445,vendor:"Edgepulse",tld:"com",category:"health",popularity:.29},{id:446,vendor:"Wordtune",tld:"gov",category:"electronics",popularity:.67},{id:447,vendor:"Ntags",tld:"org",category:"kids",popularity:.42},{id:448,vendor:"Divavu",tld:"gov",category:"automotive",popularity:.72},{id:449,vendor:"Skyble",tld:"mil",category:"tools",popularity:.93},{id:450,vendor:"Viva",tld:"mil",category:"grocery",popularity:1.07},{id:451,vendor:"Bubblebox",tld:"net",category:"automotive",popularity:.33},{id:452,vendor:"Twinder",tld:"org",category:"baby",popularity:.19},{id:453,vendor:"Feedbug",tld:"gov",category:"jewelry",popularity:.72},{id:454,vendor:"Yodoo",tld:"org",category:"shoes",popularity:.23},{id:455,vendor:"Dynava",tld:"org",category:"automotive",popularity:.99},{id:456,vendor:"Pixonyx",tld:"com",category:"grocery",popularity:.64},{id:457,vendor:"Jaxworks",tld:"com",category:"outdoors",popularity:.68},{id:458,vendor:"Yakijo",tld:"info",category:"jewelry",popularity:.57},{id:459,vendor:"Fivespan",tld:"org",category:"garden",popularity:.17},{id:460,vendor:"Camido",tld:"biz",category:"toys",popularity:.76},{id:461,vendor:"Mycat",tld:"name",category:"computers",popularity:.69},{id:462,vendor:"Twitternation",tld:"mil",category:"health",popularity:.36},{id:463,vendor:"Divavu",tld:"net",category:"shoes",popularity:.66},{id:464,vendor:"Thoughtstorm",tld:"info",category:"games",popularity:.52},{id:465,vendor:"Aibox",tld:"edu",category:"clothing",popularity:.75},{id:466,vendor:"Mita",tld:"biz",category:"home",popularity:.1},{id:467,vendor:"Livetube",tld:"biz",category:"games",popularity:.48},{id:468,vendor:"Flipstorm",tld:"gov",category:"industrial",popularity:.57},{id:469,vendor:"Thoughtmix",tld:"biz",category:"kids",popularity:.4},{id:470,vendor:"Topiclounge",tld:"biz",category:"garden",popularity:.43},{id:471,vendor:"Mydeo",tld:"name",category:"books",popularity:.65},{id:472,vendor:"Ooba",tld:"info",category:"industrial",popularity:.42},{id:473,vendor:"LiveZ",tld:"com",category:"industrial",popularity:.31},{id:474,vendor:"Kayveo",tld:"mil",category:"garden",popularity:.27},{id:475,vendor:"Gabcube",tld:"org",category:"clothing",popularity:.73},{id:476,vendor:"Meejo",tld:"org",category:"outdoors",popularity:.4},{id:477,vendor:"Dynazzy",tld:"gov",category:"books",popularity:.76},{id:478,vendor:"Tavu",tld:"name",category:"movies",popularity:.95},{id:479,vendor:"Kazio",tld:"info",category:"electronics",popularity:.34},{id:480,vendor:"Photobean",tld:"info",category:"games",popularity:.38},{id:481,vendor:"Oyoba",tld:"net",category:"grocery",popularity:.79},{id:482,vendor:"Divanoodle",tld:"org",category:"toys",popularity:.46},{id:483,vendor:"Voomm",tld:"mil",category:"garden",popularity:.66},{id:484,vendor:"Miboo",tld:"info",category:"toys",popularity:.67},{id:485,vendor:"Jatri",tld:"org",category:"industrial",popularity:.75},{id:486,vendor:"Shufflebeat",tld:"info",category:"automotive",popularity:.85},{id:487,vendor:"Jazzy",tld:"mil",category:"computers",popularity:.59},{id:488,vendor:"Omba",tld:"com",category:"games",popularity:.41},{id:489,vendor:"Yamia",tld:"info",category:"garden",popularity:.25},{id:490,vendor:"Eimbee",tld:"gov",category:"books",popularity:.35},{id:491,vendor:"Quimba",tld:"com",category:"books",popularity:.83},{id:492,vendor:"Jabbercube",tld:"edu",category:"kids",popularity:.93},{id:493,vendor:"Thoughtstorm",tld:"name",category:"games",popularity:.68},{id:494,vendor:"Eayo",tld:"name",category:"toys",popularity:.62},{id:495,vendor:"Meembee",tld:"gov",category:"music",popularity:.27},{id:496,vendor:"BlogXS",tld:"gov",category:"sports",popularity:.59},{id:497,vendor:"Twitterworks",tld:"net",category:"games",popularity:.72},{id:498,vendor:"Dynabox",tld:"edu",category:"computers",popularity:.94},{id:499,vendor:"Yakidoo",tld:"com",category:"grocery",popularity:.77},{id:500,vendor:"Feednation",tld:"org",category:"beauty",popularity:1.24},{id:501,vendor:"Divape",tld:"biz",category:"garden",popularity:.5},{id:502,vendor:"InnoZ",tld:"org",category:"books",popularity:.79},{id:503,vendor:"Gigazoom",tld:"mil",category:"electronics",popularity:.55},{id:504,vendor:"Rhycero",tld:"info",category:"books",popularity:1.05},{id:505,vendor:"Yodel",tld:"org",category:"garden",popularity:.25},{id:506,vendor:"Browseblab",tld:"net",category:"sports",popularity:.36},{id:507,vendor:"Yamia",tld:"info",category:"tools",popularity:.32},{id:508,vendor:"Jaxnation",tld:"org",category:"electronics",popularity:.69},{id:509,vendor:"Chatterpoint",tld:"edu",category:"baby",popularity:.43},{id:510,vendor:"Tazzy",tld:"org",category:"automotive",popularity:.51},{id:511,vendor:"Yotz",tld:"info",category:"tools",popularity:.52},{id:512,vendor:"Wikivu",tld:"info",category:"sports",popularity:.6},{id:513,vendor:"Fatz",tld:"name",category:"garden",popularity:.65},{id:514,vendor:"Yodoo",tld:"com",category:"tools",popularity:.21},{id:515,vendor:"Devify",tld:"org",category:"automotive",popularity:.32},{id:516,vendor:"Wikizz",tld:"org",category:"books",popularity:.37},{id:517,vendor:"Skivee",tld:"edu",category:"shoes",popularity:.27},{id:518,vendor:"Trupe",tld:"edu",category:"movies",popularity:.83},{id:519,vendor:"Oyoloo",tld:"edu",category:"music",popularity:.67},{id:520,vendor:"Podcat",tld:"biz",category:"books",popularity:.23},{id:521,vendor:"Kazu",tld:"biz",category:"clothing",popularity:.27},{id:522,vendor:"Agivu",tld:"gov",category:"toys",popularity:.63},{id:523,vendor:"Avavee",tld:"info",category:"computers",popularity:.44},{id:524,vendor:"Leenti",tld:"mil",category:"toys",popularity:.52},{id:525,vendor:"Bubblemix",tld:"edu",category:"health",popularity:.27},{id:526,vendor:"Voomm",tld:"net",category:"clothing",popularity:.34},{id:527,vendor:"Eire",tld:"com",category:"jewelry",popularity:.21},{id:528,vendor:"Roombo",tld:"org",category:"clothing",popularity:.47},{id:529,vendor:"Eayo",tld:"biz",category:"music",popularity:.67},{id:530,vendor:"Ooba",tld:"name",category:"games",popularity:.45},{id:531,vendor:"Youspan",tld:"org",category:"health",popularity:-.08},{id:532,vendor:"Jaxbean",tld:"mil",category:"tools",popularity:.11},{id:533,vendor:"Meezzy",tld:"edu",category:"kids",popularity:.54},{id:534,vendor:"Flashpoint",tld:"com",category:"outdoors",popularity:.34},{id:535,vendor:"Riffpath",tld:"biz",category:"health",popularity:.53},{id:536,vendor:"Edgeclub",tld:"name",category:"garden",popularity:.37},{id:537,vendor:"Thoughtbeat",tld:"edu",category:"sports",popularity:.15},{id:538,vendor:"Cogidoo",tld:"com",category:"games",popularity:.67},{id:539,vendor:"Mydeo",tld:"name",category:"movies",popularity:.66},{id:540,vendor:"Browsezoom",tld:"edu",category:"home",popularity:.35},{id:541,vendor:"Feednation",tld:"org",category:"games",popularity:.65},{id:542,vendor:"Camimbo",tld:"mil",category:"music",popularity:.37},{id:543,vendor:"Skipstorm",tld:"mil",category:"tools",popularity:.13},{id:544,vendor:"Skinder",tld:"org",category:"sports",popularity:.57},{id:545,vendor:"Twimm",tld:"name",category:"beauty",popularity:-.08},{id:546,vendor:"Yadel",tld:"gov",category:"shoes",popularity:.44},{id:547,vendor:"Skajo",tld:"biz",category:"toys",popularity:.66},{id:548,vendor:"Voolith",tld:"info",category:"jewelry",popularity:.93},{id:549,vendor:"Yamia",tld:"edu",category:"shoes",popularity:.3},{id:550,vendor:"Bubbletube",tld:"info",category:"beauty",popularity:.21},{id:551,vendor:"Oyonder",tld:"edu",category:"home",popularity:.36},{id:552,vendor:"Tazzy",tld:"mil",category:"tools",popularity:.77},{id:553,vendor:"Voonyx",tld:"com",category:"computers",popularity:.29},{id:554,vendor:"Linkbuzz",tld:"biz",category:"shoes",popularity:.66},{id:555,vendor:"Myworks",tld:"info",category:"music",popularity:.52},{id:556,vendor:"Jabbertype",tld:"biz",category:"tools",popularity:.36},{id:557,vendor:"Brightdog",tld:"com",category:"electronics",popularity:.71},{id:558,vendor:"Meembee",tld:"name",category:"home",popularity:.27},{id:559,vendor:"Voonix",tld:"name",category:"computers",popularity:.18},{id:560,vendor:"Gigabox",tld:"edu",category:"computers",popularity:.26},{id:561,vendor:"Browsezoom",tld:"com",category:"kids",popularity:.57},{id:562,vendor:"Yombu",tld:"biz",category:"automotive",popularity:.37},{id:563,vendor:"Devshare",tld:"biz",category:"toys",popularity:.52},{id:564,vendor:"Photofeed",tld:"edu",category:"automotive",popularity:.57},{id:565,vendor:"Realcube",tld:"mil",category:"industrial",popularity:.09},{id:566,vendor:"Brainbox",tld:"edu",category:"health",popularity:.69},{id:567,vendor:"Kamba",tld:"info",category:"garden",popularity:.33},{id:568,vendor:"Yodel",tld:"name",category:"home",popularity:.59},{id:569,vendor:"Mydo",tld:"info",category:"outdoors",popularity:.81},{id:570,vendor:"Youopia",tld:"biz",category:"beauty",popularity:.44},{id:571,vendor:"Tagchat",tld:"mil",category:"jewelry",popularity:.45},{id:572,vendor:"Quire",tld:"info",category:"health",popularity:.53},{id:573,vendor:"Shuffledrive",tld:"biz",category:"toys",popularity:.77},{id:574,vendor:"Browseblab",tld:"org",category:"tools",popularity:.47},{id:575,vendor:"Flashset",tld:"name",category:"electronics",popularity:.55},{id:576,vendor:"Tagfeed",tld:"name",category:"outdoors",popularity:.46},{id:577,vendor:"Skyndu",tld:"mil",category:"health",popularity:-.03},{id:578,vendor:"Dynabox",tld:"edu",category:"music",popularity:.99},{id:579,vendor:"Leexo",tld:"net",category:"industrial",popularity:.39},{id:580,vendor:"Plajo",tld:"info",category:"jewelry",popularity:.12},{id:581,vendor:"Yabox",tld:"name",category:"movies",popularity:.32},{id:582,vendor:"Snaptags",tld:"edu",category:"music",popularity:.96},{id:583,vendor:"Cogibox",tld:"com",category:"garden",popularity:.57},{id:584,vendor:"Thoughtmix",tld:"name",category:"home",popularity:.31},{id:585,vendor:"Feedfire",tld:"mil",category:"automotive",popularity:.31},{id:586,vendor:"Buzzbean",tld:"gov",category:"tools",popularity:.3},{id:587,vendor:"Youfeed",tld:"info",category:"music",popularity:.39},{id:588,vendor:"Rhynoodle",tld:"mil",category:"health",popularity:.71},{id:589,vendor:"Zoovu",tld:"mil",category:"automotive",popularity:.45},{id:590,vendor:"Yodel",tld:"biz",category:"garden",popularity:.64},{id:591,vendor:"Skilith",tld:"edu",category:"shoes",popularity:.37},{id:592,vendor:"Eadel",tld:"edu",category:"tools",popularity:.39},{id:593,vendor:"Topicblab",tld:"net",category:"books",popularity:.64},{id:594,vendor:"Yodoo",tld:"net",category:"tools",popularity:.16},{id:595,vendor:"Digitube",tld:"info",category:"automotive",popularity:.43},{id:596,vendor:"Avavee",tld:"com",category:"sports",popularity:.49},{id:597,vendor:"Cogibox",tld:"org",category:"beauty",popularity:.64},{id:598,vendor:"Skimia",tld:"biz",category:"garden",popularity:-.01},{id:599,vendor:"Skibox",tld:"biz",category:"sports",popularity:.32},{id:600,vendor:"Tagtune",tld:"org",category:"beauty",popularity:.43},{id:601,vendor:"Eare",tld:"info",category:"outdoors",popularity:.39},{id:602,vendor:"Dabjam",tld:"edu",category:"tools",popularity:.29},{id:603,vendor:"Twitterbeat",tld:"org",category:"toys",popularity:.8},{id:604,vendor:"Quimba",tld:"biz",category:"games",popularity:.59},{id:605,vendor:"Oozz",tld:"com",category:"shoes",popularity:.66},{id:606,vendor:"Yoveo",tld:"com",category:"tools",popularity:.21},{id:607,vendor:"Photofeed",tld:"org",category:"computers",popularity:.73},{id:608,vendor:"Eayo",tld:"biz",category:"electronics",popularity:.64},{id:609,vendor:"Zoonoodle",tld:"name",category:"automotive",popularity:.83},{id:610,vendor:"Livetube",tld:"info",category:"industrial",popularity:.61},{id:611,vendor:"Ailane",tld:"org",category:"electronics",popularity:.83},{id:612,vendor:"Zooveo",tld:"edu",category:"clothing",popularity:.58},{id:613,vendor:"Realbridge",tld:"info",category:"baby",popularity:.68},{id:614,vendor:"Skiptube",tld:"info",category:"outdoors",popularity:.3},{id:615,vendor:"Riffpedia",tld:"info",category:"tools",popularity:.57},{id:616,vendor:"Buzzbean",tld:"name",category:"garden",popularity:.37},{id:617,vendor:"Skibox",tld:"net",category:"games",popularity:.59},{id:618,vendor:"Topicblab",tld:"com",category:"kids",popularity:.56},{id:619,vendor:"Skaboo",tld:"com",category:"sports",popularity:1.1},{id:620,vendor:"Riffpedia",tld:"com",category:"grocery",popularity:.69},{id:621,vendor:"Oyondu",tld:"com",category:"toys",popularity:.14},{id:622,vendor:"Meevee",tld:"net",category:"shoes",popularity:.55},{id:623,vendor:"Jabbertype",tld:"gov",category:"baby",popularity:.77},{id:624,vendor:"Kanoodle",tld:"edu",category:"computers",popularity:.21},{id:625,vendor:"Tagchat",tld:"info",category:"computers",popularity:.33},{id:626,vendor:"Fadeo",tld:"com",category:"movies",popularity:.47},{id:627,vendor:"Aimbo",tld:"gov",category:"clothing",popularity:.01},{id:628,vendor:"Quimba",tld:"edu",category:"toys",popularity:.84},{id:629,vendor:"Twiyo",tld:"mil",category:"grocery",popularity:.23},{id:630,vendor:"Thoughtblab",tld:"name",category:"books",popularity:.45},{id:631,vendor:"Meembee",tld:"info",category:"beauty",popularity:.25},{id:632,vendor:"Twimbo",tld:"org",category:"books",popularity:.33},{id:633,vendor:"Brainsphere",tld:"org",category:"sports",popularity:.75},{id:634,vendor:"Quatz",tld:"edu",category:"baby",popularity:.87},{id:635,vendor:"Fanoodle",tld:"mil",category:"electronics",popularity:.2},{id:636,vendor:"Buzzshare",tld:"info",category:"tools",popularity:.59},{id:637,vendor:"Yodel",tld:"edu",category:"books",popularity:.45},{id:638,vendor:"Buzzbean",tld:"mil",category:"kids",popularity:.77},{id:639,vendor:"Kayveo",tld:"org",category:"kids",popularity:.37},{id:640,vendor:"Kare",tld:"mil",category:"books",popularity:.15},{id:641,vendor:"Cogidoo",tld:"info",category:"clothing",popularity:.33},{id:642,vendor:"Zoomdog",tld:"gov",category:"movies",popularity:.56},{id:643,vendor:"Twitterlist",tld:"name",category:"sports",popularity:.69},{id:644,vendor:"Nlounge",tld:"edu",category:"movies",popularity:.31},{id:645,vendor:"Twiyo",tld:"net",category:"baby",popularity:.63},{id:646,vendor:"Feedfire",tld:"edu",category:"music",popularity:.97},{id:647,vendor:"Trunyx",tld:"mil",category:"kids",popularity:.33},{id:648,vendor:"Skyble",tld:"gov",category:"garden",popularity:.39},{id:649,vendor:"Npath",tld:"name",category:"outdoors",popularity:.68},{id:650,vendor:"Meedoo",tld:"info",category:"jewelry",popularity:.39},{id:651,vendor:"Skivee",tld:"net",category:"electronics",popularity:.72},{id:652,vendor:"Fiveclub",tld:"org",category:"outdoors",popularity:.5},{id:653,vendor:"Talane",tld:"org",category:"home",popularity:.55},{id:654,vendor:"Jaxbean",tld:"com",category:"computers",popularity:.56},{id:655,vendor:"Realblab",tld:"edu",category:"toys",popularity:.05},{id:656,vendor:"Eamia",tld:"name",category:"books",popularity:.35},{id:657,vendor:"Meevee",tld:"net",category:"computers",popularity:.82},{id:658,vendor:"Lazz",tld:"edu",category:"baby",popularity:.51},{id:659,vendor:"Ntags",tld:"edu",category:"movies",popularity:.68},{id:660,vendor:"Dabfeed",tld:"mil",category:"industrial",popularity:.7},{id:661,vendor:"Linklinks",tld:"gov",category:"home",popularity:.82},{id:662,vendor:"Wikizz",tld:"info",category:"clothing",popularity:.5},{id:663,vendor:"Gigaclub",tld:"net",category:"kids",popularity:.62},{id:664,vendor:"Cogilith",tld:"gov",category:"garden",popularity:.31},{id:665,vendor:"Chatterbridge",tld:"edu",category:"electronics",popularity:.88},{id:666,vendor:"Ntags",tld:"biz",category:"movies",popularity:.15},{id:667,vendor:"Flipopia",tld:"edu",category:"sports",popularity:.6},{id:668,vendor:"Feednation",tld:"info",category:"sports",popularity:.43},{id:669,vendor:"Rooxo",tld:"info",category:"health",popularity:.36},{id:670,vendor:"Yoveo",tld:"com",category:"shoes",popularity:.34},{id:671,vendor:"Lazzy",tld:"org",category:"movies",popularity:.29},{id:672,vendor:"Shufflester",tld:"name",category:"health",popularity:.78},{id:673,vendor:"Demimbu",tld:"gov",category:"books",popularity:.65},{id:674,vendor:"Katz",tld:"net",category:"baby",popularity:.38},{id:675,vendor:"InnoZ",tld:"com",category:"tools",popularity:.58},{id:676,vendor:"Zooveo",tld:"net",category:"shoes",popularity:.18},{id:677,vendor:"Wordtune",tld:"name",category:"kids",popularity:.41},{id:678,vendor:"Skajo",tld:"org",category:"kids",popularity:.37},{id:679,vendor:"Rooxo",tld:"net",category:"movies",popularity:.21},{id:680,vendor:"Youspan",tld:"biz",category:"tools",popularity:.74},{id:681,vendor:"Topicshots",tld:"gov",category:"shoes",popularity:.47},{id:682,vendor:"Brainverse",tld:"mil",category:"games",popularity:.38},{id:683,vendor:"Flashdog",tld:"gov",category:"movies",popularity:.61},{id:684,vendor:"Feedbug",tld:"net",category:"home",popularity:.83},{id:685,vendor:"Centimia",tld:"name",category:"books",popularity:.15},{id:686,vendor:"Twitternation",tld:"biz",category:"tools",popularity:.18},{id:687,vendor:"Oyondu",tld:"biz",category:"electronics",popularity:-.12},{id:688,vendor:"Flipbug",tld:"org",category:"health",popularity:.34},{id:689,vendor:"Gevee",tld:"name",category:"beauty",popularity:.75},{id:690,vendor:"Eadel",tld:"net",category:"industrial",popularity:.89},{id:691,vendor:"Dabjam",tld:"biz",category:"tools",popularity:.85},{id:692,vendor:"Fadeo",tld:"org",category:"jewelry",popularity:.08},{id:693,vendor:"Babbleblab",tld:"org",category:"games",popularity:.21},{id:694,vendor:"Linkbuzz",tld:"edu",category:"grocery",popularity:.03},{id:695,vendor:"Youfeed",tld:"net",category:"games",popularity:.53},{id:696,vendor:"Oyoba",tld:"com",category:"movies",popularity:1.08},{id:697,vendor:"Oloo",tld:"name",category:"toys",popularity:.68},{id:698,vendor:"Livetube",tld:"net",category:"outdoors",popularity:.36},{id:699,vendor:"Realcube",tld:"com",category:"movies",popularity:.61},{id:700,vendor:"Jaxworks",tld:"org",category:"shoes",popularity:.21},{id:701,vendor:"Divanoodle",tld:"org",category:"toys",popularity:.89},{id:702,vendor:"Skilith",tld:"org",category:"computers",popularity:.16},{id:703,vendor:"Livefish",tld:"name",category:"garden",popularity:.5},{id:704,vendor:"Kayveo",tld:"org",category:"computers",popularity:.8},{id:705,vendor:"Twitterbridge",tld:"gov",category:"grocery",popularity:.74},{id:706,vendor:"Edgewire",tld:"edu",category:"shoes",popularity:.39},{id:707,vendor:"Riffpedia",tld:"edu",category:"electronics",popularity:.47},{id:708,vendor:"Camido",tld:"mil",category:"movies",popularity:1},{id:709,vendor:"Jayo",tld:"com",category:"jewelry",popularity:.42},{id:710,vendor:"Katz",tld:"name",category:"kids",popularity:.73},{id:711,vendor:"Livefish",tld:"com",category:"baby",popularity:.42},{id:712,vendor:"Latz",tld:"net",category:"health",popularity:.41},{id:713,vendor:"Mybuzz",tld:"gov",category:"home",popularity:.46},{id:714,vendor:"Twitternation",tld:"edu",category:"shoes",popularity:.18},{id:715,vendor:"Photojam",tld:"com",category:"automotive",popularity:.51},{id:716,vendor:"Browseblab",tld:"net",category:"kids",popularity:.19},{id:717,vendor:"Yozio",tld:"com",category:"automotive",popularity:1.02},{id:718,vendor:"Quimm",tld:"com",category:"clothing",popularity:.63},{id:719,vendor:"Skynoodle",tld:"gov",category:"games",popularity:.22},{id:720,vendor:"Rhynyx",tld:"gov",category:"games",popularity:.74},{id:721,vendor:"Devpulse",tld:"mil",category:"sports",popularity:.43},{id:722,vendor:"Fivechat",tld:"info",category:"kids",popularity:.45},{id:723,vendor:"Trudoo",tld:"mil",category:"clothing",popularity:.38},{id:724,vendor:"Kayveo",tld:"biz",category:"books",popularity:.46},{id:725,vendor:"Ooba",tld:"gov",category:"automotive",popularity:.81},{id:726,vendor:"Oloo",tld:"name",category:"computers",popularity:.88},{id:727,vendor:"BlogXS",tld:"edu",category:"garden",popularity:.53},{id:728,vendor:"Riffpedia",tld:"com",category:"electronics",popularity:.41},{id:729,vendor:"Fivechat",tld:"info",category:"garden",popularity:.31},{id:730,vendor:"Pixope",tld:"biz",category:"home",popularity:.39},{id:731,vendor:"Flashdog",tld:"mil",category:"books",popularity:.82},{id:732,vendor:"Yombu",tld:"mil",category:"jewelry",popularity:.34},{id:733,vendor:"Trilia",tld:"biz",category:"home",popularity:.83},{id:734,vendor:"Shuffledrive",tld:"info",category:"beauty",popularity:.45},{id:735,vendor:"Skaboo",tld:"mil",category:"computers",popularity:.52},{id:736,vendor:"Oodoo",tld:"biz",category:"kids",popularity:.27},{id:737,vendor:"Kazu",tld:"com",category:"automotive",popularity:.66},{id:738,vendor:"Gigazoom",tld:"com",category:"computers",popularity:.7},{id:739,vendor:"Mydo",tld:"org",category:"tools",popularity:.6},{id:740,vendor:"Browsezoom",tld:"edu",category:"automotive",popularity:.78},{id:741,vendor:"Youopia",tld:"biz",category:"music",popularity:.62},{id:742,vendor:"Babbleset",tld:"mil",category:"jewelry",popularity:.73},{id:743,vendor:"Omba",tld:"mil",category:"electronics",popularity:.49},{id:744,vendor:"Trilith",tld:"com",category:"music",popularity:.49},{id:745,vendor:"Topiczoom",tld:"info",category:"health",popularity:0},{id:746,vendor:"Blogspan",tld:"gov",category:"health",popularity:.55},{id:747,vendor:"Shufflebeat",tld:"net",category:"kids",popularity:.53},{id:748,vendor:"Oyonder",tld:"edu",category:"shoes",popularity:.81},{id:749,vendor:"Tagopia",tld:"biz",category:"clothing",popularity:.1},{id:750,vendor:"Pixoboo",tld:"net",category:"computers",popularity:.5},{id:751,vendor:"Skipstorm",tld:"name",category:"movies",popularity:1.07},{id:752,vendor:"Youtags",tld:"biz",category:"electronics",popularity:.56},{id:753,vendor:"Wordware",tld:"info",category:"tools",popularity:.75},{id:754,vendor:"Zoonder",tld:"mil",category:"sports",popularity:.48},{id:755,vendor:"Brainverse",tld:"mil",category:"beauty",popularity:.25},{id:756,vendor:"Feedfire",tld:"gov",category:"clothing",popularity:.81},{id:757,vendor:"Tanoodle",tld:"gov",category:"movies",popularity:.63},{id:758,vendor:"Devbug",tld:"mil",category:"electronics",popularity:.31},{id:759,vendor:"Voolia",tld:"name",category:"grocery",popularity:.39},{id:760,vendor:"LiveZ",tld:"gov",category:"electronics",popularity:.48},{id:761,vendor:"InnoZ",tld:"gov",category:"garden",popularity:.8},{id:762,vendor:"Photobean",tld:"gov",category:"baby",popularity:.55},{id:763,vendor:"Digitube",tld:"edu",category:"clothing",popularity:.04},{id:764,vendor:"Abata",tld:"mil",category:"health",popularity:.62},{id:765,vendor:"Oloo",tld:"mil",category:"garden",popularity:.23},{id:766,vendor:"Katz",tld:"name",category:"outdoors",popularity:.63},{id:767,vendor:"Fivechat",tld:"edu",category:"kids",popularity:.53},{id:768,vendor:"Dabtype",tld:"org",category:"grocery",popularity:.27},{id:769,vendor:"Vitz",tld:"gov",category:"beauty",popularity:.12},{id:770,vendor:"Yambee",tld:"mil",category:"movies",popularity:.64},{id:771,vendor:"LiveZ",tld:"gov",category:"kids",popularity:.33},{id:772,vendor:"Pixope",tld:"net",category:"home",popularity:.39},{id:773,vendor:"Gabtune",tld:"info",category:"industrial",popularity:.68},{id:774,vendor:"Voonyx",tld:"gov",category:"beauty",popularity:.47},{id:775,vendor:"Jetwire",tld:"gov",category:"health",popularity:.43},{id:776,vendor:"Meejo",tld:"org",category:"games",popularity:.67},{id:777,vendor:"Dynabox",tld:"info",category:"grocery",popularity:.55},{id:778,vendor:"Kayveo",tld:"biz",category:"shoes",popularity:.42},{id:779,vendor:"Abatz",tld:"name",category:"industrial",popularity:.3},{id:780,vendor:"Linklinks",tld:"org",category:"computers",popularity:.13},{id:781,vendor:"Zoozzy",tld:"org",category:"garden",popularity:.4},{id:782,vendor:"Topiclounge",tld:"name",category:"toys",popularity:.42},{id:783,vendor:"Skipstorm",tld:"org",category:"home",popularity:.63},{id:784,vendor:"Jazzy",tld:"info",category:"baby",popularity:.33},{id:785,vendor:"Skiptube",tld:"net",category:"health",popularity:.73},{id:786,vendor:"Bubblebox",tld:"gov",category:"jewelry",popularity:.93},{id:787,vendor:"Izio",tld:"name",category:"health",popularity:.68},{id:788,vendor:"Skinder",tld:"edu",category:"baby",popularity:-.02},{id:789,vendor:"Mita",tld:"org",category:"sports",popularity:.64},{id:790,vendor:"Eabox",tld:"edu",category:"home",popularity:.15},{id:791,vendor:"Wordpedia",tld:"mil",category:"music",popularity:0},{id:792,vendor:"Oba",tld:"name",category:"clothing",popularity:.29},{id:793,vendor:"Meemm",tld:"biz",category:"automotive",popularity:.84},{id:794,vendor:"Vimbo",tld:"mil",category:"books",popularity:.2},{id:795,vendor:"Yakidoo",tld:"info",category:"books",popularity:.92},{id:796,vendor:"Voomm",tld:"com",category:"shoes",popularity:.45},{id:797,vendor:"Browsezoom",tld:"org",category:"automotive",popularity:.58},{id:798,vendor:"Yakitri",tld:"com",category:"books",popularity:.74},{id:799,vendor:"Twiyo",tld:"name",category:"tools",popularity:.65},{id:800,vendor:"Feedmix",tld:"com",category:"toys",popularity:.48},{id:801,vendor:"Tagtune",tld:"com",category:"clothing",popularity:.39},{id:802,vendor:"Youtags",tld:"org",category:"outdoors",popularity:.05},{id:803,vendor:"Babbleblab",tld:"net",category:"toys",popularity:.5},{id:804,vendor:"Wordpedia",tld:"edu",category:"automotive",popularity:.74},{id:805,vendor:"Kwinu",tld:"net",category:"home",popularity:.7},{id:806,vendor:"Meetz",tld:"org",category:"toys",popularity:.69},{id:807,vendor:"Realfire",tld:"com",category:"shoes",popularity:.7},{id:808,vendor:"Quimba",tld:"mil",category:"computers",popularity:.62},{id:809,vendor:"Lajo",tld:"com",category:"books",popularity:.45},{id:810,vendor:"Abata",tld:"gov",category:"clothing",popularity:.47},{id:811,vendor:"Skinix",tld:"com",category:"baby",popularity:.71},{id:812,vendor:"Ntags",tld:"biz",category:"health",popularity:.06},{id:813,vendor:"Ainyx",tld:"com",category:"shoes",popularity:.46},{id:814,vendor:"Tagtune",tld:"name",category:"music",popularity:.72},{id:815,vendor:"Twitterlist",tld:"gov",category:"home",popularity:.61},{id:816,vendor:"Kazio",tld:"edu",category:"garden",popularity:.21},{id:817,vendor:"Agimba",tld:"biz",category:"computers",popularity:.5},{id:818,vendor:"Quimm",tld:"mil",category:"garden",popularity:.32},{id:819,vendor:"Brainverse",tld:"biz",category:"grocery",popularity:.34},{id:820,vendor:"Twinder",tld:"biz",category:"music",popularity:.79},{id:821,vendor:"Twitterworks",tld:"org",category:"industrial",popularity:.26},{id:822,vendor:"Photospace",tld:"com",category:"industrial",popularity:.2},{id:823,vendor:"Thoughtblab",tld:"org",category:"computers",popularity:.51},{id:824,vendor:"Pixoboo",tld:"gov",category:"electronics",popularity:.54},{id:825,vendor:"Quire",tld:"org",category:"electronics",popularity:.52},{id:826,vendor:"Vitz",tld:"com",category:"beauty",popularity:.57},{id:827,vendor:"Vimbo",tld:"gov",category:"health",popularity:.25},{id:828,vendor:"Dabvine",tld:"com",category:"beauty",popularity:.45},{id:829,vendor:"Devpulse",tld:"net",category:"movies",popularity:.51},{id:830,vendor:"Layo",tld:"net",category:"games",popularity:.39},{id:831,vendor:"Zoomlounge",tld:"org",category:"games",popularity:.49},{id:832,vendor:"Browsetype",tld:"com",category:"kids",popularity:.14},{id:833,vendor:"Brainverse",tld:"biz",category:"garden",popularity:.79},{id:834,vendor:"Izio",tld:"org",category:"movies",popularity:.5},{id:835,vendor:"Vipe",tld:"info",category:"books",popularity:.76},{id:836,vendor:"Dablist",tld:"edu",category:"books",popularity:-.11},{id:837,vendor:"Eayo",tld:"com",category:"clothing",popularity:.54},{id:838,vendor:"Yozio",tld:"mil",category:"garden",popularity:.76},{id:839,vendor:"Ntag",tld:"info",category:"industrial",popularity:.72},{id:840,vendor:"Feedfish",tld:"gov",category:"kids",popularity:.62},{id:841,vendor:"Myworks",tld:"org",category:"computers",popularity:.74},{id:842,vendor:"Voomm",tld:"net",category:"baby",popularity:.31},{id:843,vendor:"Realblab",tld:"name",category:"garden",popularity:.57},{id:844,vendor:"Realfire",tld:"edu",category:"home",popularity:.49},{id:845,vendor:"Dabshots",tld:"edu",category:"tools",popularity:.49},{id:846,vendor:"Topicblab",tld:"org",category:"grocery",popularity:.37},{id:847,vendor:"BlogXS",tld:"edu",category:"tools",popularity:.78},{id:848,vendor:"Skalith",tld:"name",category:"automotive",popularity:.03},{id:849,vendor:"Abata",tld:"net",category:"industrial",popularity:.27},{id:850,vendor:"Jetwire",tld:"info",category:"games",popularity:.67},{id:851,vendor:"Youopia",tld:"gov",category:"computers",popularity:.33},{id:852,vendor:"Eare",tld:"org",category:"sports",popularity:.48},{id:853,vendor:"Skippad",tld:"biz",category:"kids",popularity:.48},{id:854,vendor:"Vitz",tld:"com",category:"toys",popularity:0},{id:855,vendor:"Wikibox",tld:"mil",category:"jewelry",popularity:.34},{id:856,vendor:"Skilith",tld:"edu",category:"industrial",popularity:.79},{id:857,vendor:"Voolia",tld:"com",category:"garden",popularity:.64},{id:858,vendor:"Vimbo",tld:"mil",category:"beauty",popularity:-.1},{id:859,vendor:"Topiclounge",tld:"name",category:"tools",popularity:.59},{id:860,vendor:"Rhynyx",tld:"name",category:"books",popularity:.21},{id:861,vendor:"Livetube",tld:"biz",category:"kids",popularity:.36},{id:862,vendor:"Agivu",tld:"info",category:"games",popularity:.82},{id:863,vendor:"Skiptube",tld:"gov",category:"jewelry",popularity:.39},{id:864,vendor:"Twitterlist",tld:"info",category:"books",popularity:1.16},{id:865,vendor:"Kwinu",tld:"biz",category:"kids",popularity:.8},{id:866,vendor:"Roodel",tld:"org",category:"books",popularity:.67},{id:867,vendor:"Livepath",tld:"net",category:"clothing",popularity:.51},{id:868,vendor:"Midel",tld:"net",category:"automotive",popularity:.99},{id:869,vendor:"Fadeo",tld:"net",category:"tools",popularity:.3},{id:870,vendor:"Roombo",tld:"name",category:"movies",popularity:.88},{id:871,vendor:"Zooxo",tld:"gov",category:"beauty",popularity:1.01},{id:872,vendor:"Babbleopia",tld:"gov",category:"sports",popularity:.36},{id:873,vendor:"Kazu",tld:"net",category:"beauty",popularity:.81},{id:874,vendor:"Kwideo",tld:"name",category:"music",popularity:.5},{id:875,vendor:"Meezzy",tld:"info",category:"electronics",popularity:.61},{id:876,vendor:"Yozio",tld:"name",category:"music",popularity:.62},{id:877,vendor:"Twitterbeat",tld:"edu",category:"kids",popularity:.69},{id:878,vendor:"Avamm",tld:"net",category:"health",popularity:.21},{id:879,vendor:"Snaptags",tld:"name",category:"toys",popularity:.76},{id:880,vendor:"Youopia",tld:"edu",category:"health",popularity:.43},{id:881,vendor:"Zooxo",tld:"net",category:"garden",popularity:.8},{id:882,vendor:"Ailane",tld:"edu",category:"movies",popularity:.9},{id:883,vendor:"Voolith",tld:"name",category:"industrial",popularity:.38},{id:884,vendor:"Edgeblab",tld:"net",category:"toys",popularity:.48},{id:885,vendor:"Twitternation",tld:"biz",category:"clothing",popularity:.42},{id:886,vendor:"Babbleblab",tld:"info",category:"computers",popularity:.5},{id:887,vendor:"Topdrive",tld:"com",category:"books",popularity:.54},{id:888,vendor:"Tagtune",tld:"biz",category:"toys",popularity:.2},{id:889,vendor:"Feedmix",tld:"edu",category:"toys",popularity:.39},{id:890,vendor:"Tagchat",tld:"org",category:"grocery",popularity:.33},{id:891,vendor:"Thoughtstorm",tld:"mil",category:"music",popularity:.1},{id:892,vendor:"Kazio",tld:"net",category:"books",popularity:.87},{id:893,vendor:"Vipe",tld:"edu",category:"outdoors",popularity:.49},{id:894,vendor:"Browsezoom",tld:"mil",category:"health",popularity:.57},{id:895,vendor:"Jaxnation",tld:"name",category:"sports",popularity:.34},{id:896,vendor:"Mybuzz",tld:"info",category:"kids",popularity:.54},{id:897,vendor:"Wikizz",tld:"info",category:"jewelry",popularity:.5},{id:898,vendor:"Kazio",tld:"info",category:"clothing",popularity:.56},{id:899,vendor:"Yoveo",tld:"net",category:"industrial",popularity:.24},{id:900,vendor:"Topiclounge",tld:"gov",category:"outdoors",popularity:.44},{id:901,vendor:"Yata",tld:"gov",category:"garden",popularity:.11},{id:902,vendor:"Skimia",tld:"biz",category:"electronics",popularity:.19},{id:903,vendor:"Topicware",tld:"gov",category:"jewelry",popularity:.43},{id:904,vendor:"Ooba",tld:"com",category:"books",popularity:.11},{id:905,vendor:"Edgeclub",tld:"name",category:"home",popularity:.37},{id:906,vendor:"Trilith",tld:"name",category:"industrial",popularity:.6},{id:907,vendor:"Eidel",tld:"org",category:"home",popularity:.43},{id:908,vendor:"Flipbug",tld:"mil",category:"health",popularity:.48},{id:909,vendor:"Twitterworks",tld:"net",category:"automotive",popularity:.47},{id:910,vendor:"Edgepulse",tld:"edu",category:"movies",popularity:.42},{id:911,vendor:"Vinder",tld:"gov",category:"garden",popularity:.77},{id:912,vendor:"Trilia",tld:"com",category:"music",popularity:0},{id:913,vendor:"Jabbersphere",tld:"org",category:"kids",popularity:.7},{id:914,vendor:"Yakitri",tld:"info",category:"games",popularity:.26},{id:915,vendor:"Mymm",tld:"edu",category:"music",popularity:.43},{id:916,vendor:"Linkbuzz",tld:"edu",category:"clothing",popularity:.53},{id:917,vendor:"Yadel",tld:"mil",category:"grocery",popularity:.09},{id:918,vendor:"Rooxo",tld:"gov",category:"industrial",popularity:.7},{id:919,vendor:"Mybuzz",tld:"info",category:"clothing",popularity:.3},{id:920,vendor:"Aimbu",tld:"info",category:"baby",popularity:.32},{id:921,vendor:"Eazzy",tld:"edu",category:"beauty",popularity:.14},{id:922,vendor:"Agivu",tld:"com",category:"electronics",popularity:.76},{id:923,vendor:"Devify",tld:"info",category:"automotive",popularity:.7},{id:924,vendor:"Vinte",tld:"gov",category:"movies",popularity:.29},{id:925,vendor:"Tanoodle",tld:"info",category:"movies",popularity:.61},{id:926,vendor:"Meetz",tld:"com",category:"toys",popularity:.24},{id:927,vendor:"Youopia",tld:"net",category:"games",popularity:.7},{id:928,vendor:"Yakidoo",tld:"net",category:"shoes",popularity:.63},{id:929,vendor:"Buzzbean",tld:"mil",category:"beauty",popularity:.36},{id:930,vendor:"Podcat",tld:"com",category:"outdoors",popularity:.57},{id:931,vendor:"Kare",tld:"org",category:"shoes",popularity:.64},{id:932,vendor:"Wikido",tld:"org",category:"tools",popularity:.7},{id:933,vendor:"Youspan",tld:"net",category:"shoes",popularity:.48},{id:934,vendor:"Quimm",tld:"net",category:"shoes",popularity:.46},{id:935,vendor:"Cogibox",tld:"biz",category:"sports",popularity:.23},{id:936,vendor:"Browsebug",tld:"edu",category:"shoes",popularity:.98},{id:937,vendor:"Devify",tld:"info",category:"industrial",popularity:.75},{id:938,vendor:"Janyx",tld:"biz",category:"jewelry",popularity:.72},{id:939,vendor:"Mydo",tld:"org",category:"books",popularity:.79},{id:940,vendor:"Avamm",tld:"name",category:"games",popularity:.82},{id:941,vendor:"Gigashots",tld:"mil",category:"garden",popularity:.07},{id:942,vendor:"Avamba",tld:"edu",category:"jewelry",popularity:.49},{id:943,vendor:"Eimbee",tld:"info",category:"toys",popularity:.78},{id:944,vendor:"Edgeify",tld:"gov",category:"books",popularity:.64},{id:945,vendor:"Oloo",tld:"mil",category:"kids",popularity:.68},{id:946,vendor:"Meembee",tld:"com",category:"games",popularity:.36},{id:947,vendor:"Jetpulse",tld:"edu",category:"games",popularity:1},{id:948,vendor:"Babbleblab",tld:"org",category:"health",popularity:.47},{id:949,vendor:"Tagpad",tld:"gov",category:"health",popularity:.44},{id:950,vendor:"Leexo",tld:"net",category:"industrial",popularity:.16},{id:951,vendor:"Voomm",tld:"edu",category:"shoes",popularity:.51},{id:952,vendor:"JumpXS",tld:"com",category:"home",popularity:.75},{id:953,vendor:"Skalith",tld:"gov",category:"computers",popularity:.48},{id:954,vendor:"Photobug",tld:"name",category:"movies",popularity:.56},{id:955,vendor:"Fatz",tld:"edu",category:"garden",popularity:.47},{id:956,vendor:"Youbridge",tld:"net",category:"clothing",popularity:.44},{id:957,vendor:"Tagpad",tld:"com",category:"sports",popularity:-.05},{id:958,vendor:"Twimm",tld:"net",category:"jewelry",popularity:.53},{id:959,vendor:"Meejo",tld:"org",category:"automotive",popularity:.65},{id:960,vendor:"Photobean",tld:"mil",category:"industrial",popularity:.11},{id:961,vendor:"Edgetag",tld:"org",category:"beauty",popularity:1.05},{id:962,vendor:"Skimia",tld:"gov",category:"garden",popularity:.59},{id:963,vendor:"Youtags",tld:"info",category:"industrial",popularity:.4},{id:964,vendor:"Skynoodle",tld:"net",category:"industrial",popularity:.67},{id:965,vendor:"Feedbug",tld:"info",category:"kids",popularity:.57},{id:966,vendor:"Eare",tld:"name",category:"sports",popularity:.3},{id:967,vendor:"Chatterpoint",tld:"name",category:"beauty",popularity:.21},{id:968,vendor:"Youspan",tld:"biz",category:"electronics",popularity:.47},{id:969,vendor:"BlogXS",tld:"mil",category:"movies",popularity:.88},{id:970,vendor:"DabZ",tld:"info",category:"clothing",popularity:.53},{id:971,vendor:"Feedfire",tld:"biz",category:"industrial",popularity:.79},{id:972,vendor:"Realcube",tld:"mil",category:"toys",popularity:.35},{id:973,vendor:"Avavee",tld:"org",category:"clothing",popularity:.63},{id:974,vendor:"Quatz",tld:"edu",category:"electronics",popularity:.32},{id:975,vendor:"Zoombeat",tld:"com",category:"outdoors",popularity:1.21},{id:976,vendor:"Realfire",tld:"mil",category:"tools",popularity:.24},{id:977,vendor:"Topicware",tld:"biz",category:"industrial",popularity:.68},{id:978,vendor:"Oyondu",tld:"name",category:"health",popularity:.86},{id:979,vendor:"Thoughtstorm",tld:"net",category:"toys",popularity:.3},{id:980,vendor:"Jayo",tld:"com",category:"clothing",popularity:.58},{id:981,vendor:"Jabberstorm",tld:"biz",category:"movies",popularity:.53},{id:982,vendor:"Topiclounge",tld:"com",category:"beauty",popularity:.17},{id:983,vendor:"Oyondu",tld:"edu",category:"health",popularity:.54},{id:984,vendor:"Yakidoo",tld:"gov",category:"shoes",popularity:.7},{id:985,vendor:"Edgewire",tld:"edu",category:"industrial",popularity:.56},{id:986,vendor:"Yodo",tld:"mil",category:"clothing",popularity:.42},{id:987,vendor:"Oozz",tld:"info",category:"shoes",popularity:.62},{id:988,vendor:"Linkbridge",tld:"edu",category:"clothing",popularity:.43},{id:989,vendor:"Livetube",tld:"gov",category:"jewelry",popularity:.29},{id:990,vendor:"Leexo",tld:"name",category:"movies",popularity:.24},{id:991,vendor:"Topdrive",tld:"info",category:"electronics",popularity:.94},{id:992,vendor:"Kaymbo",tld:"net",category:"music",popularity:.8},{id:993,vendor:"Rooxo",tld:"mil",category:"toys",popularity:.28},{id:994,vendor:"Feedmix",tld:"net",category:"computers",popularity:1},{id:995,vendor:"Pixonyx",tld:"edu",category:"industrial",popularity:.32},{id:996,vendor:"Yakidoo",tld:"gov",category:"shoes",popularity:.46},{id:997,vendor:"Linklinks",tld:"name",category:"shoes",popularity:.27},{id:998,vendor:"Fivechat",tld:"name",category:"grocery",popularity:.6},{id:999,vendor:"Jaxspan",tld:"mil",category:"baby",popularity:.48},{id:1e3,vendor:"Feednation",tld:"net",category:"industrial",popularity:.27}];const er=0,ye={name:"New York",lonlat:[-73.993562,40.727063],diameter:.15},or=500,tr=(e,o)=>h(e,`
      INSERT INTO cities (city_name, center, diameter)
      VALUES (?, ?, ?)
      ON DUPLICATE KEY UPDATE
        center = VALUES(center),
        diameter = VALUES(diameter)
    `,o.name,`POINT(${o.lonlat[0]} ${o.lonlat[1]})`,o.diameter),rr=["olc_8","olc_6","purchase","request"],ir=["minute","hour","day","week","month"],Oo=({interval:e,kind:o,value:t})=>tt(`${e}-${o}-${t}`),ar=async(e,o)=>{const t=new Ro("segments",["segment_id","valid_interval","filter_kind","filter_value"]);for(const r of o)t.append(Oo(r),r.interval,r.kind,r.value);await h(e,t.sql(),...t.params())},nr=async(e,o,t=er)=>{const r=new Ro("offers",["customer_id","notification_zone","segment_ids","notification_content","notification_target","maximum_bid_cents"]);let a=0,n=[];const d=async()=>{await Promise.all([h(e,r.sql(),...r.params()),ar(e,n)]),r.clear(),n=[],a=0};for(const s of o)r.append(t,s.notificationZone,JSON.stringify(s.segments.map(Oo)),s.notificationContent,s.notificationTarget,s.maximumBidCents),a++,n=n.concat(s.segments),a>=or&&await d();a>0&&await d()},be=e=>e[Math.floor(Math.random()*e.length)],Le=(e,o)=>Math.random()*(o-e)+e,te=(e,o)=>Math.floor(Le(e,o)),ke=()=>be(qt),dr=()=>be(rr),lr=()=>be(ir),Io=({vendor:e,tld:o})=>`${e.toLowerCase()}.${o}`,Ao=e=>{const[o,t]=e.lonlat,r=e.diameter/2,[a,n]=[o-r,o+r],[d,s]=[t-r,t+r];return[Le(a,n),Le(d,s)]},sr=e=>{const o=dr(),t=lr();switch(o){case"olc_8":case"olc_6":{const[r,a]=Ao(e),n=o==="olc_8"?8:6,d=we.encode(a,r,n).substring(0,n);return{kind:o,interval:t,value:d}}case"purchase":return{kind:o,interval:t,value:ke().vendor};case"request":return{kind:o,interval:t,value:Io(ke())}}},cr=e=>{const o=te(1,3),t=Array.from({length:o},()=>sr(e)),r=ke(),a=Io(r),n=te(10,50),d=te(1,1e3),s=`${n}% off at ${r.vendor}`,l=`https://${a}/s2cellular?offerId=${d}`,[p,y]=Ao(e),m=we.encode(y,p,be([8,10])),v=we.decode(m),S={ne:[v.latitudeHi,v.longitudeHi],sw:[v.latitudeLo,v.longitudeLo]};return{segments:t,notificationZone:Ye(S),notificationContent:s,notificationTarget:l,maximumBidCents:te(2,15)}},pr=(e,o)=>Array.from({length:o},()=>cr(e));var He=[{name:"date_sub_dynamic",createStmt:`CREATE OR REPLACE FUNCTION date_sub_dynamic (
  _dt DATETIME(6),
  _interval ENUM("second", "minute", "hour", "day", "week", "month")
) RETURNS DATETIME(6) AS
BEGIN
  RETURN CASE _interval
    WHEN "second" THEN _dt - INTERVAL 1 SECOND
    WHEN "minute" THEN _dt - INTERVAL 1 MINUTE
    WHEN "hour" THEN _dt - INTERVAL 1 HOUR
    WHEN "day" THEN _dt - INTERVAL 1 DAY
    WHEN "week" THEN _dt - INTERVAL 1 WEEK
    WHEN "month" THEN _dt - INTERVAL 1 MONTH
  END;
END`},{name:"encode_open_location_code",createStmt:`CREATE OR REPLACE FUNCTION encode_open_location_code (
  _lonlat GEOGRAPHYPOINT,
  codeLength INT DEFAULT 12
) RETURNS TEXT AS
DECLARE
  SEPARATOR_ text = '+';
  SEPARATOR_POSITION_ int = 8;
  PADDING_CHARACTER_ text = '0';
  CODE_ALPHABET_ text = '23456789CFGHJMPQRVWX';
  ENCODING_BASE_ int = CHARACTER_LENGTH(CODE_ALPHABET_);
  LATITUDE_MAX_ int = 90;
  LONGITUDE_MAX_ int = 180;
  MAX_DIGIT_COUNT_ int = 15;
  PAIR_CODE_LENGTH_ int = 10;
  PAIR_PRECISION_ decimal = POWER(ENCODING_BASE_, 3);
  GRID_CODE_LENGTH_ int = MAX_DIGIT_COUNT_ - PAIR_CODE_LENGTH_;
  GRID_COLUMNS_ int = 4;
  GRID_ROWS_ int = 5;
  FINAL_LAT_PRECISION_ decimal = PAIR_PRECISION_ * POWER(GRID_ROWS_, MAX_DIGIT_COUNT_ - PAIR_CODE_LENGTH_);
  FINAL_LNG_PRECISION_ decimal = PAIR_PRECISION_ * POWER(GRID_COLUMNS_, MAX_DIGIT_COUNT_ - PAIR_CODE_LENGTH_);
  latitude double = geography_latitude(_lonlat);
  longitude double = geography_longitude(_lonlat);
  code text = '';
  latVal decimal = 0;
  lngVal decimal = 0;
  latDigit smallint;
  lngDigit smallint;
  ndx smallint;
  i_ smallint;
BEGIN
  -- This function has been ported from:
  -- http://github.com/google/open-location-code/blob/cafb35c0d74dd0c06b6a75c05f89e32a972b7b23/plpgsql/pluscode_functions.sql#L313
  -- Licensed under the Apache License, Version 2.0 (the 'License')

  IF ((codeLength < 2) OR ((codeLength < PAIR_CODE_LENGTH_) AND (codeLength % 2 = 1)) OR (codeLength > MAX_DIGIT_COUNT_)) THEN
    RAISE USER_EXCEPTION(CONCAT('Invalid Open Location Code length - ', codeLength));
  END IF;

  latVal = floor(round((latitude + LATITUDE_MAX_) * FINAL_LAT_PRECISION_, 6));
  lngVal = floor(round((longitude + LONGITUDE_MAX_) * FINAL_LNG_PRECISION_, 6));

  IF (codeLength > PAIR_CODE_LENGTH_) THEN
    i_ = 0;
    WHILE (i_ < (MAX_DIGIT_COUNT_ - PAIR_CODE_LENGTH_)) LOOP
      latDigit = latVal % GRID_ROWS_;
      lngDigit = lngVal % GRID_COLUMNS_;
      ndx = (latDigit * GRID_COLUMNS_) + lngDigit;
      code = concat(substr(CODE_ALPHABET_, ndx + 1, 1), code);
      latVal = latVal DIV GRID_ROWS_;
      lngVal = lngVal DIV GRID_COLUMNS_;
      i_ = i_ + 1;
    END LOOP;
  ELSE
    latVal = latVal DIV power(GRID_ROWS_, GRID_CODE_LENGTH_);
    lngVal = lngVal DIV power(GRID_COLUMNS_, GRID_CODE_LENGTH_);
  END IF;

  i_ = 0;
  WHILE (i_ < (PAIR_CODE_LENGTH_ / 2)) LOOP
    code = concat(substr(CODE_ALPHABET_, (lngVal % ENCODING_BASE_) + 1, 1), code);
    code = concat(substr(CODE_ALPHABET_, (latVal % ENCODING_BASE_) + 1, 1), code);
    latVal = latVal DIV ENCODING_BASE_;
    lngVal = lngVal DIV ENCODING_BASE_;
    i_ = i_ + 1;
  END LOOP;

  code = concat(
    substr(code, 1, SEPARATOR_POSITION_),
    SEPARATOR_,
    substr(code, SEPARATOR_POSITION_ + 1)
  );

  IF (codeLength > SEPARATOR_POSITION_) THEN
    RETURN substr(code, 1, codeLength+1);
  ELSE
    RETURN substr(code, 1, codeLength);
  END IF;
END`}],je=[{name:"process_locations",createStmt:`CREATE OR REPLACE PROCEDURE process_locations (
    _batch QUERY(
        city_id BIGINT NOT NULL,
        subscriber_id BIGINT NOT NULL,
        lonlat GEOGRAPHYPOINT NOT NULL
    )
)
AS
BEGIN
    INSERT INTO subscribers
    SELECT city_id, subscriber_id, lonlat
    FROM _batch
    ON DUPLICATE KEY UPDATE current_location = VALUES(current_location);

    INSERT INTO locations
    SELECT
        city_id,
        subscriber_id,
        now(6) AS ts,
        lonlat,
        encode_open_location_code(lonlat, 8) AS olc_8
    FROM _batch;
END`},{name:"run_matching_process",createStmt:`CREATE OR REPLACE PROCEDURE run_matching_process (
  _interval ENUM("second", "minute", "hour", "day", "week", "month")
) RETURNS BIGINT
AS
DECLARE
    _ts DATETIME = NOW(6);
    _count BIGINT;
BEGIN
    INSERT INTO notifications SELECT _ts, * FROM match_offers_to_subscribers(_interval);

    _count = row_count();

    INSERT INTO subscribers_last_notification
    SELECT city_id, subscriber_id, ts
    FROM notifications
    WHERE ts = _ts
    ON DUPLICATE KEY UPDATE last_notification = _ts;

    RETURN _count;
END`},{name:"update_segments",createStmt:`CREATE OR REPLACE PROCEDURE update_segments() RETURNS BIGINT
AS
DECLARE
    _count BIGINT;
BEGIN
    START TRANSACTION;

    DELETE FROM subscriber_segments;

    INSERT INTO subscriber_segments
    SELECT * FROM dynamic_subscriber_segments;

    _count = row_count();

    COMMIT;

    RETURN _count;
END`}],We=[{name:"cities",createStmt:`create rowstore reference table if not exists cities (
  city_id BIGINT NOT NULL AUTO_INCREMENT PRIMARY KEY,
  city_name TEXT NOT NULL,
  center GEOGRAPHYPOINT NOT NULL,
  diameter DOUBLE,

  UNIQUE KEY (city_name)
);`},{name:"subscribers",createStmt:`create rowstore table if not exists subscribers (
  city_id BIGINT NOT NULL,
  subscriber_id BIGINT NOT NULL,
  current_location GEOGRAPHYPOINT NOT NULL,

  PRIMARY KEY (city_id, subscriber_id),
  INDEX (current_location)
);`},{name:"subscribers_last_notification",createStmt:`create rowstore table if not exists subscribers_last_notification (
  city_id BIGINT NOT NULL,
  subscriber_id BIGINT NOT NULL,
  last_notification DATETIME(6),

  PRIMARY KEY (city_id, subscriber_id),
  INDEX (last_notification)
);`},{name:"locations",createStmt:`create table if not exists locations (
  city_id BIGINT NOT NULL,
  subscriber_id BIGINT NOT NULL,
  ts DATETIME(6) NOT NULL SERIES TIMESTAMP,
  lonlat GEOGRAPHYPOINT NOT NULL,

  -- open location code length 8 (275m resolution)
  olc_8 TEXT NOT NULL,
  -- open location code length 6 (5.5km resolution)
  olc_6 AS SUBSTR(olc_8, 1, 6) PERSISTED TEXT,

  SHARD KEY (city_id, subscriber_id),
  SORT KEY (ts),

  KEY (city_id, subscriber_id) USING HASH,
  KEY (olc_8) USING HASH,
  KEY (olc_6) USING HASH
);`},{name:"requests",createStmt:`create table if not exists requests (
  city_id BIGINT NOT NULL,
  subscriber_id BIGINT NOT NULL,
  ts DATETIME(6) NOT NULL SERIES TIMESTAMP,
  domain TEXT NOT NULL,

  SHARD KEY (city_id, subscriber_id),
  SORT KEY (ts),
  KEY (domain) USING HASH
);`},{name:"purchases",createStmt:`create table if not exists purchases (
  city_id BIGINT NOT NULL,
  subscriber_id BIGINT NOT NULL,
  ts DATETIME(6) NOT NULL SERIES TIMESTAMP,
  vendor TEXT NOT NULL,

  SHARD KEY (city_id, subscriber_id),
  SORT KEY (ts),
  KEY (vendor) USING HASH
);`},{name:"customers",createStmt:`create table if not exists customers (
  customer_id BIGINT NOT NULL,
  company_name TEXT NOT NULL,

  PRIMARY KEY (customer_id)
);`},{name:"offers",createStmt:`create rowstore reference table if not exists offers (
  offer_id BIGINT NOT NULL AUTO_INCREMENT,
  customer_id BIGINT NOT NULL,
  enabled BOOLEAN NOT NULL DEFAULT TRUE,

  notification_zone GEOGRAPHY NOT NULL,
  segment_ids JSON NOT NULL,

  notification_content TEXT NOT NULL,
  notification_target TEXT NOT NULL,

  maximum_bid_cents BIGINT NOT NULL,

  PRIMARY KEY (offer_id),
  INDEX (notification_zone)
);`},{name:"notifications",createStmt:`create table if not exists notifications (
  ts DATETIME(6) NOT NULL SERIES TIMESTAMP,

  city_id BIGINT NOT NULL,
  subscriber_id BIGINT NOT NULL,

  offer_id BIGINT NOT NULL,
  cost_cents BIGINT NOT NULL,
  lonlat GEOGRAPHYPOINT NOT NULL,

  SHARD KEY (city_id, subscriber_id),
  SORT KEY (ts)
);`},{name:"segments",createStmt:`create rowstore reference table segments (
  segment_id BIGINT NOT NULL,

  valid_interval ENUM ("minute", "hour", "day", "week", "month") NOT NULL,
  filter_kind ENUM ("olc_8", "olc_6", "request", "purchase") NOT NULL,
  filter_value TEXT NOT NULL,

  PRIMARY KEY (segment_id),
  UNIQUE KEY (valid_interval, filter_kind, filter_value),
  KEY (filter_kind, filter_value)
);`},{name:"subscriber_segments",createStmt:`create table subscriber_segments (
  city_id BIGINT NOT NULL,
  subscriber_id BIGINT NOT NULL,
  segment_id BIGINT NOT NULL,

  UNIQUE KEY (city_id, subscriber_id, segment_id) USING HASH,
  SORT KEY (city_id, subscriber_id, segment_id),
  SHARD KEY (city_id, subscriber_id)
);`},{name:"match_offers_to_subscribers",createStmt:`CREATE OR REPLACE FUNCTION match_offers_to_subscribers(
  _interval ENUM("second", "minute", "hour", "day", "week", "month")
) RETURNS TABLE AS RETURN (
  WITH
    phase_1 as (
      SELECT offers.*, subscribers.*
      FROM
        offers,
        subscribers
      -- grab last notification time for each subscriber
      -- with(table_convert_subselect=true) forces a hash join
      LEFT JOIN subscribers_last_notification with(table_convert_subselect=true) ON (
        subscribers.city_id = subscribers_last_notification.city_id
        AND subscribers.subscriber_id = subscribers_last_notification.subscriber_id
      )
      WHERE
        offers.enabled = TRUE

        -- match offers to subscribers based on current location
        AND geography_contains(offers.notification_zone, subscribers.current_location)

        -- ensure we don't spam subscribers
        AND (
          subscribers_last_notification.last_notification IS NULL
          OR subscribers_last_notification.last_notification < date_sub_dynamic(NOW(), _interval)
        )

      -- only match (offer, subscriber) pairs such that
      -- there is no matching notification in the last minute
      AND NOT EXISTS (
        SELECT * FROM notifications n
        WHERE
          ts > date_sub_dynamic(NOW(), _interval)
          AND offers.offer_id = n.offer_id
          AND subscribers.city_id = n.city_id
          AND subscribers.subscriber_id = n.subscriber_id
      )
    ),
    phase_2 as (
      select
        phase_1.*,
        row_number() over (
          partition by phase_1.offer_id, phase_1.city_id, phase_1.subscriber_id
        ) as num_matching_segments
      from phase_1
      JOIN TABLE(JSON_TO_ARRAY(phase_1.segment_ids)) AS segment_ids
      LEFT JOIN subscriber_segments segment ON (
        phase_1.city_id = segment.city_id
        AND phase_1.subscriber_id = segment.subscriber_id
        AND segment_ids.table_col :> BIGINT = segment.segment_id
      )
    )
  select
    city_id,
    subscriber_id,
    -- window to find one offer with highest bid per subscriber
    last_value(offer_id) over window_best_offer as best_offer_id,
    last_value(maximum_bid_cents) over window_best_offer as cost_cents,
    current_location
  from phase_2
  where json_length(segment_ids) = num_matching_segments
  group by city_id, subscriber_id
  WINDOW window_best_offer as (
    partition by city_id, subscriber_id
    order by maximum_bid_cents asc
  )
);`},{name:"dynamic_subscriber_segments",createStmt:`create view dynamic_subscriber_segments as (
  SELECT city_id, subscriber_id, segment_id
  FROM segments, locations
  WHERE
    segments.filter_kind = "olc_8"
    AND segments.filter_value = locations.olc_8
    AND ts >= date_sub_dynamic(NOW(6), segments.valid_interval)
  UNION
  SELECT city_id, subscriber_id, segment_id
  FROM segments, locations
  WHERE
    segments.filter_kind = "olc_6"
    AND segments.filter_value = locations.olc_6
    AND ts >= date_sub_dynamic(NOW(6), segments.valid_interval)
  UNION
  SELECT city_id, subscriber_id, segment_id
  FROM segments, requests
  WHERE
    segments.filter_kind = "request"
    AND segments.filter_value = requests.domain
    AND ts >= date_sub_dynamic(NOW(6), segments.valid_interval)
  UNION
  SELECT city_id, subscriber_id, segment_id
  FROM segments, purchases
  WHERE
    segments.filter_kind = "purchase"
    AND segments.filter_value = purchases.vendor
    AND ts >= date_sub_dynamic(NOW(6), segments.valid_interval)
);`}];const yr=[`CREATE LINK aws_s3 AS S3 CREDENTIALS '{}' CONFIG '{ "region": "us-east-1" }'`,"REPLACE INTO customers VALUES (0, 'default customer')"],ur=async e=>{try{return await Ae(e,"SELECT 1"),!0}catch{return!1}},gr=async e=>{let o={tables:[],procedures:[],functions:[]};const s=e,{database:t}=s,r=L(s,["database"]);try{o=(await Ge(r,`
          SELECT "tables", table_name
          FROM information_schema.tables
          WHERE table_schema = ?
          UNION ALL
          SELECT (
            CASE routine_type
              WHEN 'PROCEDURE' THEN 'procedures'
              WHEN 'FUNCTION' THEN 'functions'
            END
          ), routine_name
          FROM information_schema.routines
          WHERE routine_schema = ?
        `,t||"s2cellular",t||"s2cellular")).reduce((l,[p,y])=>(l[p].push(y),l),o)}catch(l){if(!(l instanceof O&&(l.isUnknownDatabase()||l.isDatabaseRecovering())))throw l}const{tables:a,procedures:n,functions:d}=o;return Object.fromEntries([We.map(({name:l})=>[l,a.includes(l)]),je.map(({name:l})=>[l,n.includes(l)]),He.map(({name:l})=>[l,d.includes(l)])].flat())},mr=async(e,{progress:o,scaleFactor:t,includeSeedData:r,skipCreate:a=!1})=>{a||(o("Dropping existing schema","info"),await Ae(e,"DROP DATABASE IF EXISTS `"+e.database+"`"),o("Creating database","info"),await Ae(e,"CREATE DATABASE `"+e.database+"`"));for(const n of He)o(`Creating function: ${n.name}`,"info"),await h(e,n.createStmt);for(const n of We)o(`Creating table: ${n.name}`,"info"),await h(e,n.createStmt);for(const n of je)o(`Creating procedure: ${n.name}`,"info"),await h(e,n.createStmt);await vr(e),await tr(e,ye),r&&(o("Creating sample data","info"),await Lo(e,t)),o("Schema initialized","success")},vr=e=>Promise.all(yr.map(o=>h(e,o))),Lo=(e,o)=>{const t=100*o.partitions,r=pr(f(b({},ye),{diameter:.1}),t);return nr(e,r)},ko=async(e,o)=>{const t=o.prefix;return await q(e,`
      SELECT
        expected.city_id AS cityId,
        expected.city_name AS cityName,
        GEOGRAPHY_LONGITUDE(expected.center) AS lon,
        GEOGRAPHY_LATITUDE(expected.center) AS lat,
        expected.diameter,
        pipelineName,
        (
          pipelines.pipeline_name IS NULL
          OR config_json::$connection_string NOT LIKE "%${t}%"
        ) AS needsUpdate
      FROM (
        SELECT cities.*, CONCAT(prefix.table_col, cities.city_id) AS pipelineName
        FROM s2cellular.cities
        JOIN TABLE(["locations_", "requests_", "purchases_"]) AS prefix
      ) AS expected
      LEFT JOIN information_schema.pipelines
        ON pipelines.database_name = ?
        AND pipelines.pipeline_name = expected.pipelineName
    `,e.database||"s2cellular")},Co=async(e,o)=>{const t=o.prefix,r=await ko(e,o);await Promise.all(r.filter(a=>a.needsUpdate).map(async a=>{console.log(`recreating pipeline ${a.pipelineName} for city ${a.cityName}`),a.pipelineName.startsWith("locations_")?await h(e,`
            CREATE OR REPLACE PIPELINE ${a.pipelineName}
            AS LOAD DATA LINK aws_s3 's2cellular/${t}/locations.*'
            INTO PROCEDURE process_locations FORMAT PARQUET (
              subscriber_id <- subscriberid,
              @offset_x <- offsetX,
              @offset_y <- offsetY
            )
            SET
              city_id = ?,
              lonlat = GEOGRAPHY_POINT(
                ? + (@offset_x * ?),
                ? + (@offset_y * ?)
              )
          `,a.cityId,a.lon,a.diameter,a.lat,a.diameter):a.pipelineName.startsWith("requests_")?await h(e,`
            CREATE OR REPLACE PIPELINE ${a.pipelineName}
            AS LOAD DATA LINK aws_s3 's2cellular/${t}/requests.*'
            INTO TABLE requests FORMAT PARQUET (
              subscriber_id <- subscriberid,
              domain <- domain
            )
            SET ts = NOW(),
              city_id = ?;
          `,a.cityId):a.pipelineName.startsWith("purchases_")&&await h(e,`
            CREATE OR REPLACE PIPELINE ${a.pipelineName}
            AS LOAD DATA LINK aws_s3 's2cellular/${t}/purchases.*'
            INTO TABLE purchases FORMAT PARQUET (
              subscriber_id <- subscriberid,
              vendor <- vendor
            )
            SET ts = NOW(),
              city_id = ?;
          `,a.cityId),await h(e,`ALTER PIPELINE ${a.pipelineName} SET OFFSETS EARLIEST DROP ORPHAN FILES`),await h(e,`START PIPELINE IF NOT RUNNING ${a.pipelineName}`),console.log(`finished creating pipeline ${a.pipelineName} for city ${a.cityName}`)}))},br=async e=>{const o=await Ge(e,`
      SELECT
        pipelines.pipeline_name,
        state,
        SUM(file_state = "Loaded"):>int AS num_loaded,
        COUNT(*) AS num_total
      FROM
        information_schema.pipelines_files,
        information_schema.pipelines
      WHERE
        pipelines_files.pipeline_name = pipelines.pipeline_name
        AND pipelines_files.database_name = pipelines.database_name
        AND pipelines.database_name = ?
      GROUP BY pipelines.pipeline_name
      HAVING num_loaded = num_total OR state != "Running"
    `,e.database||"s2cellular");await Promise.all(o.map(async([t])=>{console.log("restarting pipeline",t),await h(e,`ALTER PIPELINE ${t} SET OFFSETS EARLIEST DROP ORPHAN FILES`),await h(e,`START PIPELINE IF NOT RUNNING ${t}`)}))},zo=async e=>{const o=await q(e,`
      SELECT plan_id AS planId
      FROM information_schema.plancache
      WHERE
        plan_warnings LIKE "%empty tables%"
    `);return await Promise.all(o.map(({planId:t})=>h(e,`DROP ${t} FROM PLANCACHE`))),o.length>0},hr=(e,...o)=>{const t=o.map(r=>`"${r}"`).join(",");return wo(e,`
      SELECT tableName, MAX(count) :> BIGINT AS count
      FROM (
        SELECT
          table_name AS tableName,
          SUM(rows) AS count
        FROM information_schema.table_statistics stats
        INNER JOIN information_schema.mv_nodes nodes ON (
          stats.host = nodes.ip_addr
          AND stats.port = nodes.port
        )
        WHERE
          (
            partition_type = "Master"
            OR (
              partition_type = "Reference" AND nodes.type = "MA"
            )
          )
          AND database_name = ?
          AND table_name IN (${t})
        GROUP BY table_name
        UNION ALL
        SELECT table_col AS tableName, 0 AS count
        FROM TABLE([${t}])
      )
      GROUP BY tableName
    `,e.database||"s2cellular")},Ve=(e,...o)=>hr(e,...o).then(t=>t.reduce((r,{tableName:a,count:n})=>(r[a]=n,r),{})),fr=async(e,o)=>{const{maxRows:t}=o,a=["locations","requests","purchases","notifications"].map(d=>`"${d}"`).join(","),n=await wo(e,`
      SELECT
        stats.table_name AS tableName,
        stats.count,
        UNIX_TIMESTAMP(minmax.minTs) AS minTs,
        UNIX_TIMESTAMP(minmax.maxTs) AS maxTs
      FROM
        (
          SELECT database_name, table_name, SUM(rows) AS count
          FROM information_schema.table_statistics
          WHERE
            database_name = ?
            AND table_name IN (${a})
            AND partition_type = "Master"
          GROUP BY database_name, table_name
        ) stats,
        (
          SELECT
            database_name, table_name,
            MIN(min_value) AS minTs,
            MAX(max_value) AS maxTs
          FROM information_schema.columnar_segments
          WHERE column_name = "ts"
          GROUP BY database_name, table_name
        ) minmax
      WHERE
        stats.database_name = minmax.database_name
        AND stats.table_name = minmax.table_name
        AND stats.count > ?
    `,e.database||"s2cellular",t);await Promise.all(n.map(async({tableName:d,count:s,minTs:l,maxTs:p})=>{const m=(s-t)/s;if(m<.2)return;const v=new Date((l+m*(p-l))*1e3);console.log(`removing rows from ${d} older than ${v.toISOString()}`),await h(e,`DELETE FROM ${d} WHERE ts <= ?`,v.toISOString())}))},Ke=(e,o="minute")=>No(e,"ECHO run_matching_process(?)",o).then(t=>t.RESULT),$e=e=>No(e,"ECHO update_segments()").then(o=>o.RESULT),_r=(e,o,t,r)=>Ge(e,`
      SELECT
        ts,
        GEOGRAPHY_LONGITUDE(lonlat) AS lon,
        GEOGRAPHY_LATITUDE(lonlat) AS lat
      FROM notifications
      WHERE
        ts > ?
        AND GEOGRAPHY_CONTAINS(?, lonlat)
      ORDER BY ts DESC
      LIMIT ${t}
    `,o,Ye(r)),Er=(e,o,t)=>q(e,`
      SELECT
        offer_id AS offerId,
        notification_zone AS notificationZone
      FROM offers
      WHERE GEOGRAPHY_INTERSECTS(?, notification_zone)
      LIMIT ${o}
    `,Ye(t)),Tr=Object.fromEntries([We.map(({name:e})=>[e,!1]),je.map(({name:e})=>[e,!1]),He.map(({name:e})=>[e,!1])].flat()),xo=(e=!1)=>{const o=g(E);return x(["schemaObjects",o,e],()=>gr(o),{isPaused:()=>e,refreshInterval:t=>Object.values(t||[]).some(a=>!a)?500:0,fallbackData:Tr})},A=()=>{const n=g(E),{database:e}=n,o=L(n,["database"]),t=g(Eo),r=x(["isConnected",o],()=>ur(o)),a=xo(!r.data);return{isVapor:!!t,connected:!!r.data,initialized:!!r.data&&Object.values(a.data||[]).every(Boolean),reset:()=>{r.mutate(),a.mutate()}}},Sr=(()=>{let e={};return o=>(o in e||(e[o]=1),`${o}(${e[o]++})`)})(),Ce=(e,{name:o,enabled:t,intervalMS:r})=>{const a=rt(Ie(o));u.exports.useEffect(()=>{if(!t)return;const n=new AbortController,d=Sr(o);console.log(`Starting ${d}: tick interval: ${r}ms`);const s=async()=>{try{if(console.time(d),n.signal.aborted)return;const l=performance.now();await e(n);const p=performance.now()-l;a(p),setTimeout(s,Math.max(0,r-p))}catch(l){if(n.signal.aborted||l instanceof O&&l.isUnknownDatabase()||l instanceof DOMException&&l.name==="AbortError")return;throw l}finally{console.timeEnd(d)}};return s(),()=>{console.log(`Stopping ${d}`),n.abort()}},[t,e,r,o,a])},Nr=({before:e,after:o,includeSeedData:t})=>{const r=g(E),a=g(K),{reset:n}=A(),[d,s]=R($),l=lo(),p=g(jt);return u.exports.useCallback(async()=>{const y=d;s(!1),e(),await mr(r,{progress(m,v){const S="reset-schema";l.isActive(S)?l.update(S,{title:m,status:v,duration:v==="success"?2e3:null,isClosable:!0}):l({id:S,title:m,status:v,duration:null})},scaleFactor:a,includeSeedData:t,skipCreate:!!p}),o(),n(),s(y)},[d,s,e,r,a,t,p,o,n,l])},Do=(e,o)=>{const[t,r]=u.exports.useState(e);return u.exports.useEffect(()=>{const a=setTimeout(()=>r(e),o);return()=>clearTimeout(a)},[e,o]),t},Po=()=>{const[{elapsed:e,isRunning:o},t]=u.exports.useReducer((r,a)=>{switch(a.type){case"start":return{start:Math.floor(performance.now()),isRunning:!0,elapsed:r.elapsed};case"stop":return{elapsed:Math.floor(performance.now())-(r.start||0),isRunning:!1}}},{isRunning:!1});return{elapsed:e,isRunning:o,startTimer:()=>t({type:"start"}),stopTimer:()=>t({type:"stop"})}},Mo=e=>{const{connected:o,initialized:t}=A(),r=so(),[a,n]=Pe(),d=g(Q),s=X.useRef(null),v=e,{skipSeedData:l,disabled:p}=v,y=L(v,["skipSeedData","disabled"]),m=Nr({before:u.exports.useCallback(()=>n.on(),[n]),after:u.exports.useCallback(()=>{n.off(),r.onClose()},[r,n]),includeSeedData:!l});return c(w,{children:[i(N,b({disabled:!o||p,onClick:r.onOpen,colorScheme:t?"green":"red"},y)),i(it,{isOpen:r.isOpen,onClose:r.onClose,closeOnEsc:!1,closeOnOverlayClick:!1,leastDestructiveRef:s,children:i(co,{children:c(at,{children:[c(po,{fontSize:"lg",fontWeight:"bold",children:[t?"Reset":"Setup"," database ",d]}),c(yo,{children:["This will ",t?"recreate":"create"," the database called ",d,". Are you sure?"]}),c(uo,{children:[i(N,{ref:s,onClick:r.onClose,disabled:a,children:"Cancel"}),i(N,{disabled:a,colorScheme:t?"red":"green",onClick:m,ml:3,children:a?i(D,{}):t?"Recreate database":"Create database"})]})]})})})]})},wr=({isOpen:e,onClose:o,finalFocusRef:t})=>{const[r,a]=R($),{connected:n,initialized:d,isVapor:s}=A();return c(nt,{isOpen:e,placement:"right",onClose:o,finalFocusRef:t,children:[i(co,{}),c(dt,{children:[i(lt,{}),i(po,{children:"Config"}),i(yo,{children:c(W,{spacing:4,children:[s?null:i(To,{showScaleFactor:!0,showDatabase:!0}),c(re,{status:n?"success":"error",borderRadius:"md",children:[i(ie,{}),i(ae,{children:n?"connected":"disconnected"}),s?i(So,{position:"absolute",right:4,top:3,size:"xs"}):null]}),c(re,{status:d?"success":"warning",borderRadius:"md",children:[i(ie,{}),i(ae,{children:"schema"}),i(Mo,{position:"absolute",right:4,top:3,size:"xs",children:d?"Reset":"Setup"})]}),c(re,{status:r?"success":"warning",borderRadius:"md",children:[i(ie,{}),i(ae,{children:"simulator"}),i(st,{position:"absolute",right:4,top:3.5,size:"md",colorScheme:r?"green":"red",isChecked:r,disabled:!n||!d,onChange:()=>a(!r)})]})]})}),i(uo,{})]})]})},to=({to:e,children:o,onClick:t})=>{const r=bt(e),a=ht({path:r.pathname,end:!0});return i(U,{as:io,to:e,px:2,py:1,onClick:t,rounded:"md",_hover:{textDecoration:"none",bg:Re("gray.300","gray.600")},fontWeight:a?"bold":"normal",href:"#",color:Re("gray.700","gray.200"),children:o})},Rr=()=>{const{colorMode:e,toggleColorMode:o}=ue(),t=so(),[r,a]=R(Kt),n=X.useRef(null),{connected:d,initialized:s}=A(),l=g($),[p]=ct("(max-width: 640px)"),y=c(w,{children:[i(to,{to:"/",onClick:t.onClose,children:"Overview"}),i(to,{to:"/map",onClick:t.onClose,children:"Map"})]});let m;return p||(m=d?s?l?"connected":"simulator disabled":"needs schema":"disconnected"),i(w,{children:i(C,{bg:Re("gray.200","gray.700"),children:c(Me,{maxW:"container.lg",children:[c(se,{h:16,alignItems:"center",justifyContent:"space-between",children:[i(Se,{size:"md",icon:t.isOpen?i(pt,{}):i(yt,{}),"aria-label":"Open Menu",display:{md:"none"},onClick:t.isOpen?t.onClose:t.onOpen}),c(ce,{spacing:8,alignItems:"center",children:[i(ge,{as:"h1",size:"lg",children:p?"S2C":"S2 Cellular"}),i(ce,{as:"nav",spacing:4,display:{base:"none",md:"flex"},children:y})]}),c(se,{alignItems:"center",gap:2,children:[c(N,{size:"sm",ref:n,onClick:()=>a(!0),colorScheme:d?s&&l?"green":"yellow":"red",children:[s?i(go,{}):i(mo,{}),p||i(me,{pl:2,children:m})]}),i(Se,{"aria-label":"Github Repo",size:"sm",icon:e==="light"?i(ut,{size:"1.4em"}):i(gt,{size:"1.4em"}),onClick:()=>window.open("https://github.com/singlestore-labs/demo-s2cellular","_blank")}),i(Se,{"aria-label":"Toggle Color Mode",size:"sm",onClick:o,icon:e==="light"?i(mt,{boxSize:"1.2em"}):i(vt,{boxSize:"1.2em"})})]})]}),t.isOpen?i(C,{pb:4,display:{md:"none"},children:i(W,{as:"nav",spacing:4,children:y})}):null,i(wr,{isOpen:r,onClose:()=>a(!1),finalFocusRef:n})]})})})},Or=e=>{const o=u.exports.useRef([]),{data:t}=x(["timeseries",e.name,...e.deps||[]],async()=>{const r=await e.fetcher();return o.current.push({data:r,ts:new Date}),o.current=o.current.slice(-e.limit),o.current},{refreshInterval:e.intervalMS});return t||[]},Ir=Be("~s"),Bo=(e,...o)=>Or({name:"estimatedRowCount",deps:o,fetcher:u.exports.useCallback(()=>Ve(e,...o),[e,o]),limit:30,intervalMS:1e3}),Uo=t=>{var r=t,{data:e}=r,o=L(r,["data"]);const{colorMode:a}=ue(),n=u.exports.useCallback(({tooltipData:l,colorScale:p})=>!p||!l?null:Object.keys(l.datumByKey).sort((y,m)=>l.datumByKey[m].datum.data[m]-l.datumByKey[y].datum.data[y]).map(y=>{const{datum:m}=l.datumByKey[y],v=m.data[y];return c(me,{mb:1,color:p(y),fontSize:"sm",children:[y,": ",Be(".4~s")(v)]},y)}),[]),d=u.exports.useCallback(l=>Ir(l).replace("G","B"),[]);if(e.length<2)return i(P,{height:o.height,children:i(D,{size:"md"})});const s=e.length>0?Object.keys(e[0].data).filter(l=>l!=="ts").map(l=>i(ft,{dataKey:l,data:e,xAccessor:p=>p==null?void 0:p.ts,yAccessor:p=>p==null?void 0:p.data[l]},l)):null;return c(_t,f(b({xScale:{type:"time"},yScale:{type:"sqrt",nice:!0,zero:!1,clamp:!0},theme:a==="light"?Et:Tt,margin:{left:0,right:50,top:10,bottom:40}},o),{children:[i(Qe,{orientation:"bottom",numTicks:5,label:"time",labelOffset:10}),i(Qe,{orientation:"right",numTicks:o.height<250?3:5,tickFormat:d,label:"rows",labelOffset:20}),s,i(St,{showVerticalCrosshair:!0,detectBounds:!1,offsetLeft:-175,offsetTop:20,renderTooltip:n})]}))},Ar=e=>(o,t,r,a=1)=>`https://stamen-tiles.a.ssl.fastly.net/${e}/${r}/${o}/${t}${a>=2?"@2x":""}.png`,Lr=c(w,{children:["Map tiles by ",i(U,{href:"http://stamen.com",children:"Stamen Design"}),", under"," ",i(U,{href:"http://creativecommons.org/licenses/by/3.0",children:"CC BY 3.0"}),". Data by ",i(U,{href:"http://openstreetmap.org",children:"OpenStreetMap"}),", under"," ",i(U,{href:"http://www.openstreetmap.org/copyright",children:"ODbL"}),"."]}),kr=[ye.lonlat[1],ye.lonlat[0]],Cr=12,zr=({width:e,height:o,bounds:t,latLngToPixel:r,useRenderer:a})=>{const n=X.useRef(null),d=u.exports.useRef(new Ue),{setup:s,update:l}=a({scene:d.current,width:e,height:o,bounds:t,latLngToPixel:r});return u.exports.useLayoutEffect(()=>{if(!n.current)throw new Error("No canvas ref");console.log("PixiMapLayer: Setup");const p=new wt({view:n.current,width:e,height:o,backgroundAlpha:0,antialias:!0}),y=d.current;return p.stage.addChild(y),s==null||s(),l&&p.ticker.add(m=>{l(m)}),()=>{console.log("PixiMapLayer: Destroy"),p.stage.removeChild(y),p.destroy(!1,{children:!1,texture:!0,baseTexture:!0})}},[o,s,l,e]),i("canvas",{ref:n})},xr=({mapState:e,latLngToPixel:o,useRenderer:t})=>{const{width:r,height:a,bounds:n}=e||{width:0,height:0};return r<=0||a<=0||!o||!n?null:i(zr,{useRenderer:t,width:r,height:a,bounds:n,latLngToPixel:o})},Je=({useRenderer:e,height:o="100%",defaultCenter:t=kr,defaultZoom:r=Cr})=>{const[a,n]=u.exports.useState(t),[d,s]=u.exports.useState(r);return i(C,{borderRadius:"lg",overflow:"hidden",height:o,children:i(Nt,{dprs:[1,2],provider:Ar("toner-lite"),attribution:Lr,maxZoom:20,center:a,zoom:d,onBoundsChanged:({center:l,zoom:p})=>{n(l),s(p)},children:i(xr,{useRenderer:e})})})},Dr=10*1e3,Fo=(e=!1)=>{const o=g(E),t=g(K),r=g($),{initialized:a}=A(),n=u.exports.useCallback(d=>{const s=f(b({},o),{ctx:d});return Promise.all([Co(s,t),br(s),fr(s,t),zo(s)])},[o,t]);Ce(n,{name:"SimulatorMonitor",enabled:a&&r&&!e,intervalMS:Dr})},Pr=1*1e3,Mr=10*1e3,Br=()=>{const e=g(E),o=g($),{initialized:t}=A(),r=u.exports.useCallback(n=>Ke(f(b({},e),{ctx:n}),"minute"),[e]);Ce(r,{name:"SimulatorMatcher",enabled:t&&o,intervalMS:Pr});const a=u.exports.useCallback(n=>$e(f(b({},e),{ctx:n})),[e]);Ce(a,{name:"SimulatorUpdateSegments",enabled:t&&o,intervalMS:Mr})},ze=1e3,ne=60*ze,de=60*ne,Ne=24*de,k=e=>e.toLocaleString(void 0,{maximumFractionDigits:2}),F=e=>e?e<ze?`${k(e)}ms`:e<ne?`${k(e/ze)}s`:e<de?`${Math.floor(e/ne)}m${F(e%ne)}`:e<Ne?`${Math.floor(e/de)}h${F(e%de)}`:`${Math.floor(e/Ne)}d${F(e%Ne)}`:"0s",Ur=100,Fr=1e3,B=class extends Ue{constructor(o){super();_(this,"latlng");_(this,"age",0);_(this,"marker");_(this,"pulse");this.latlng=o,this.marker=new Oe,this.marker.beginFill(B.markerColor).drawCircle(0,0,5).endFill(),this.addChild(this.marker),this.pulse=new Oe,this.pulse.beginFill(B.pulseColor),this.pulse.drawTorus&&this.pulse.drawTorus(0,0,4,6),this.pulse.endFill(),this.addChild(this.pulse)}update(o,t){if(this.age+=t/60,this.age>B.lifetime&&this.parent){this.parent.removeChild(this);return}const r=this.age%B.lifetime/B.lifetime,a=At(r);this.pulse.scale.set(1+a);const n=.4,d=r<n?Rt(r/n):1-Ot((r-n)/(1-n));this.pulse.alpha=d,r<n?this.marker.alpha=d:this.marker.alpha=1-It((r-n)/(1-n));const[s,l]=o(this.latlng);this.x=s,this.y=l}};let Z=B;_(Z,"lifetime",1.5),_(Z,"markerColor",306687),_(Z,"pulseColor",306687);const Go=()=>{const e=g(E),{initialized:o}=A();return u.exports.useMemo(()=>["notifications",e,o],[e,o])},Yo=({scene:e,latLngToPixel:o,bounds:t})=>{const r=u.exports.useRef(new Date().toISOString()),a=g(E),{initialized:n}=A(),d=Do(t,50),s=Go();return x(s,()=>_r(a,r.current,Ur,d),{refreshInterval:Fr,isPaused:()=>!n,onSuccess:l=>{if(l.length>0){r.current=l[0][0];for(const[,p,y]of l)e.addChild(new Z([y,p]))}}}),{update:u.exports.useCallback(l=>{for(let p=e.children.length-1;p>=0;p--)e.children[p].update(o,l)},[o,e])}},Gr=()=>{const e=g(E),o=Bo(e,"locations","requests","purchases","notifications"),t=x(["notificationsMapTableCounts",e],()=>Ve(e,"offers","subscribers","cities","segments"),{refreshInterval:1e3}),r=g(Ie("SimulatorMatcher")),a=g(Ie("SimulatorUpdateSegments")),n=Be(".4~s"),d=t.data?c(vo,{templateColumns:"repeat(auto-fit, minmax(100px, 1fr))",columnGap:2,rowGap:2,children:[c(G,{children:[i(Y,{children:"Offers"}),i(H,{children:n(t.data.offers)})]}),c(G,{children:[i(Y,{children:"Cities"}),i(H,{children:n(t.data.cities)})]}),c(G,{children:[i(Y,{children:"Subscribers"}),i(H,{children:n(t.data.subscribers)})]}),c(G,{children:[i(Y,{children:"Segments"}),i(H,{children:n(t.data.segments)})]}),c(G,{children:[i(Y,{children:"Segmentation"}),i(H,{children:F(a)})]}),c(G,{children:[i(Y,{children:"Matching"}),i(H,{children:F(r)})]})]}):null;return c(w,{children:[i(T,{children:`
          The map on this page displays notifications as they are delivered to
          subscribers in realtime. Below, you will find some key statistics
          about the demo.
        `}),d,c(C,{children:[i(me,{fontSize:"sm",fontWeight:"medium",children:"Row count / time"}),i(Uo,{data:o,height:150})]})]})},Yr=()=>{const[e,o]=R($);return Fo(),Br(),c(se,{gap:4,justifyContent:"space-between",direction:["column","column","row"],height:"100%",children:[i(W,{spacing:4,flex:"2 2 0",minHeight:"200px",maxHeight:"100%",children:i(Je,{useRenderer:Yo})}),c(W,{spacing:4,flex:"1 1 0",minWidth:"0",children:[i(T,{children:`
            S2 Cellular is a hypothetical telecom company which provides free
            cell-phone plans in exchange for delivering targeted ads to
            subscribers. To learn about how this works please visit the [overview
            page][1].

            [1]: /
          `}),e?i(Gr,{}):i(w,{children:c(re,{status:"warning",borderRadius:"md",children:[i(ie,{}),i(ae,{children:"The simulator is disabled"}),i(N,{position:"absolute",right:4,top:3,size:"xs",colorScheme:"blue",onClick:()=>o(!0),children:"Enable simulator"})]})})]})]})},Hr=1e3;class jr extends Ue{constructor(o){super();_(this,"offer");_(this,"points");_(this,"polygon");this.offer=o,this.points=Qt(o.notificationZone),this.polygon=new Oe,this.addChild(this.polygon),this.polygon.interactive=!0,this.polygon.on("mouseover",()=>{this.polygon.tint=65280}),this.polygon.on("mouseout",()=>{this.polygon.tint=16777215})}update(o){this.polygon.clear(),this.polygon.lineStyle(1,306687,1),this.polygon.beginFill(306687,.2),this.polygon.drawPolygon(this.points.flatMap(([t,r])=>o([r,t]))),this.polygon.endFill()}}const Wr=({scene:e,latLngToPixel:o,bounds:t})=>{const r=g(E),{initialized:a}=A(),n=Do(t,100);return x(["offers",r,a,n],()=>Er(r,Hr,n),{isPaused:()=>!a,onSuccess:d=>{e.removeChildren();for(let s=0;s<d.length;s++)e.addChild(new jr(d[s]))}}),{update:u.exports.useCallback(()=>{for(let d=0;d<e.children.length;d++)e.children[d].update(o)},[o,e])}},Vr=e=>i(Je,f(b({},e),{useRenderer:Wr})),z=e=>{const{completed:o,title:t,left:r,right:a}=e,{colorMode:n}=ue(),d=n==="light"?".300":".500",s=o?"gray"+d:void 0,l=(o?"green":"gray")+d;return c(w,{children:[c(pe,{children:[c(ge,{as:"h2",size:"lg",mb:4,color:s,children:[i(go,b({color:l},{boxSize:6,position:"relative",bottom:.5,mr:2})),t]}),r]}),i(pe,{children:a})]})},Kr=({connected:e,isVapor:o})=>o?i(z,{completed:e,title:"Connected",left:c(w,{children:[i(T,{children:`
                Connected to a demo cluster running in the SingleStore Managed
                Service. To disconnect and use your own cluster instead, click the button below.
              `}),i(So,{size:"xs",colorScheme:"gray"})]}),right:null}):i(z,{completed:e,title:"Connect to SingleStore",left:i(T,{children:`
            This demo requires a connection to SingleStore's HTTP API. Please
            ensure the connection details on the right are correct.
            
            **Note**: The HTTP API may need to be enabled on your SingleStore
            cluster. To do so please see [our documentation][1] or contact
            support for assistance.
            
            [1]: https://docs.singlestore.com/docs/http-api/
          `}),right:i(To,{})}),$r=({initialized:e})=>{const[o,t]=R(Q),r=xo(),{colorMode:a}=ue();return i(z,{completed:e,title:"Setup the schema",left:c(w,{children:[i(T,{children:`
              Our schema includes the database and a set of tables and views we
              need to store all of our data. Use the controls below to set the
              database name and create the schema.
            `}),i(Lt,{mt:4,mb:6}),c(ce,{alignItems:"flex-end",children:[c(xe,{flex:1,children:[i(De,{fontSize:"xs",fontWeight:"bold",textTransform:"uppercase",children:"Database name"}),i(ro,{placeholder:"s2cellular",value:o,size:"sm",onChange:n=>t(n.target.value)})]}),i(C,{flex:1,textAlign:"center",children:i(Mo,{colorScheme:"blue",size:"sm",disabled:e,skipSeedData:!0,children:e?"Schema is setup":"Setup schema"})})]})]}),right:i(no,{columns:[1,2,2],gap:1,children:Object.keys(r.data||{}).sort().map(n=>{var d;return i(pe,{bg:(((d=r.data)==null?void 0:d[n])?"green":"gray")+(a==="light"?".200":".600"),color:a==="light"?"gray.800":"gray.100",textOverflow:"ellipsis",whiteSpace:"nowrap",overflow:"hidden",borderRadius:"md",px:2,py:1,textAlign:"center",children:n},n)})})})},Ho=(e,o,t=!0)=>{var n;const r=x(["pipelineStatus",e,o],()=>ko(e,o),{isPaused:()=>!t}),a=!!((n=r.data)==null?void 0:n.every(d=>!d.needsUpdate));return{pipelines:r,completed:a}},Jr=()=>{const e=g(E),o=g(K),{pipelines:t,completed:r}=Ho(e,o);Fo(!r);const[a,n]=Pe(),d=u.exports.useCallback(async()=>{n.on(),await Co(e,o),t.mutate(),n.off()},[n,e,o,t]),s=Bo(e,"locations","requests","purchases"),l=s.length<2||s.every(({data:y})=>y.locations+y.purchases+y.requests===0);return i(z,{completed:r,title:"Ingest data",left:i(T,{children:`
            S2 Cellular needs location, request, and purchase history from each
            of it's subscribers in real time. We will simulate these streams by
            using [SingleStore Pipelines][1] to ingest data from [AWS S3][2].

            [1]: https://docs.singlestore.com/managed-service/en/load-data/about-loading-data-with-pipelines/pipeline-concepts/overview-of-pipelines.html
            [2]: https://aws.amazon.com/s3/
          `}),right:l||!r?i(P,{h:220,children:c(N,{colorScheme:"blue",size:"sm",onClick:d,disabled:r,children:[(a||r)&&i(D,{mr:2}),a?"Creating Pipelines":r?"...waiting for data":"Create pipelines"]})}):i(Uo,{data:s,height:200})})},he=(e,o=!0)=>x(["overviewTableCounts",e],()=>Ve(e,"locations","notifications","offers","purchases","requests","segments","subscriber_segments","subscribers"),{isPaused:()=>!o}),Zr=()=>{var s,l;const e=g(E),o=g(K),[t,r]=Pe(),a=he(e),n=u.exports.useCallback(async()=>{r.on(),await Lo(e,o),a.mutate(),r.off()},[e,o,a,r]),d=!!((s=a.data)==null?void 0:s.offers);return i(z,{completed:d,title:"Offers",left:i(w,{children:c(T,{children:[`
              S2 Cellular allows any company to place offers. Each offer has a
              maximum bid price, activation zone, list of segments, and
              notification content. As subscribers move around, they are
              continuously matched to offers based on their location and
              whichever segments they are members of. If multiple offers match
              the offer with the highest bid price will be selected.
            `,!d&&`
                Press the "load offers" button on the right to create some
                sample offers in New York City.
            `,d&&`
                The map to your right displays a polygon representing each
                offer's activation zone. Hover over a polygon to see it's exact
                boundary. There are ${(l=a.data)==null?void 0:l.offers} offers in the database.
            `]})}),right:d?i(Vr,{height:300}):i(P,{h:"100%",children:c(N,{onClick:n,disabled:t,children:[t&&i(D,{mr:2}),t?"loading...":d?"loaded offers!":"load offers"]})})})},Xr=({done:e,setDone:o})=>{const t=g(E);return u.exports.useEffect(()=>{if(e)return;const r=new AbortController,a=f(b({},t),{ctx:r});return(async()=>{try{for(let n=0;n<10;n++){const d=performance.now();if(await $e(a),await Ke(a,"second"),performance.now()-d<1e3||n>1&&!await zo(a))return}}catch(n){if(r.signal.aborted||n instanceof DOMException&&n.name==="AbortError")return;throw n}})().then(()=>o(!0)),()=>{r.abort()}},[t,e,o]),e?null:i(pe,{colSpan:[1,1,2],children:c(P,{w:"100%",h:"200px",color:"gray.500",children:[i(D,{size:"md",mr:4}),i(ge,{size:"md",children:"Warming up queries..."})]})})},Qr=()=>{var p;const e=g(E),o=he(e),{elapsed:t,isRunning:r,startTimer:a,stopTimer:n}=Po(),d=!!((p=o.data)==null?void 0:p.subscriber_segments),s=u.exports.useCallback(async()=>{a(),await $e(e),n(),o.mutate()},[e,o,a,n]);let l;if(t&&o.data){const{segments:y,subscriber_segments:m,locations:v,requests:S,purchases:M}=o.data,J=F(t),fe=k(v+S+M),_e=k(y),Ee=k(m);l=i(T,{children:`
          The last update evaluated ${fe} rows against ${_e} segments
          producing ${Ee} segment memberships.
          
          **This process took ${J}**.
        `})}return i(z,{completed:d,title:"Segmentation",left:i(T,{children:`
            As mentioned above, each offer includes a list of segments. A
            segment is defined by a simple rule like "bought a coffee in the
            last day" or "visited the grocery store in the last week". While we
            could evaluate all of the segments dynamically when matching offers
            to subscribers, we would be wasting a lot of compute time since
            segment memberships don't change very often. Instead we will
            use a routine to periodically cache the mapping between subscribers
            and segments.

            Click the button to run the update interactively, or run the following query in your favorite SQL client:

                select * from dynamic_subscriber_segments;
          `}),right:i(P,{h:"100%",children:c(bo,{gap:4,textAlign:"center",children:[c(N,{disabled:r,onClick:s,children:[r&&i(D,{mr:2}),r?"...running":"Match subscribers to segments"]}),l]})})})},qr=()=>{var S;const e=g(E),o=he(e),t=Go(),{mutate:r}=kt(),{elapsed:a,isRunning:n,startTimer:d,stopTimer:s}=Po(),[l,p]=u.exports.useState(0),y=!!((S=o.data)==null?void 0:S.notifications),m=u.exports.useCallback(async()=>{let M=0,J=0;for(;M===0&&J++<10;)d(),M=await Ke(e,"second");s(),p(M),o.mutate(),r(t)},[e,d,s,o,r,t]);let v;if(a&&o.data){const{offers:M,subscribers:J,subscriber_segments:fe,notifications:_e}=o.data,Ee=k(M*J+_e),jo=k(fe),Wo=F(a),Vo=k(l);v=i(T,{children:`
          The last update evaluated up to ${Ee} notification opportunities
          against ${jo} segment memberships generating ${Vo}
          notifications. This process took ${Wo}.
        `})}return i(z,{completed:y,title:"Matching",left:i(T,{children:`
            Now that we have offers and have assigned subscribers to segments,
            we are finally able to send notifications to subscriber's devices.
            In this demo, rather than actually sending notifications we will
            insert them into a table called "notifications".

            Click the button to generate notifications interactively, or run the
            following query in your favorite SQL client:

                select * from match_offers_to_subscribers("second");
          `}),right:i(P,{h:"100%",children:c(bo,{gap:4,w:"100%",children:[c(N,{disabled:n,onClick:m,children:[n&&i(D,{mr:2}),n?"...running":"Generate notifications"]}),i(C,{width:"100%",children:i(Je,{height:250,defaultZoom:12,useRenderer:Yo})}),v]})})})},ei=()=>i(z,{completed:!0,title:"Putting it all together",left:i(T,{children:`
            Nice job! At this point you are ready to step into the shoes of a S2
            Cellular data engineer. Here are some recommendations on what to do next:

            * Visit the [live demo dashboard][1]
            * Explore the s2cellular database in SingleStore Studio

            [1]: map
          `}),right:null}),oi=()=>{const e=g(E),o=g(K),{connected:t,initialized:r,isVapor:a}=A(),{completed:n}=Ho(e,o,t&&r),{data:d}=he(e,t&&r),[s,l]=u.exports.useState(!1),p=[{completed:t,component:i(Kr,{connected:t,isVapor:a},"connection")},{completed:r,component:i($r,{initialized:r},"schema")},{completed:n,component:i(Jr,{},"pipelines")},{completed:d?d.offers>0:!1,component:i(Zr,{},"offers")},{completed:s,component:i(Xr,{done:s,setDone:l},"warmup")},{completed:d?d.subscriber_segments>0:!1,component:i(Qr,{},"segmentation")},{completed:d?d.notifications>0:!1,component:i(qr,{},"matching")},{completed:!0,component:i(ei,{},"summary")}];let y=!0;const m=[];for(const{completed:v,component:S}of p)if(y)m.push(S),y=v;else break;return c(Me,{maxW:"container.lg",mt:10,mb:"30vh",children:[i(C,{maxW:"container.md",mb:10,px:0,children:i(T,{children:`
            ## Welcome to S2 Cellular!

            S2 Cellular is a hypothetical telecom company which provides free
            cell-phone plans in exchange for delivering targeted ads to
            subscribers. To do this, S2 Cellular collects location, browser, and
            purchase history from devices and stores it in SingleStore. Before we
            can deliver ads, we need to place subscribers in segments via
            comparing their history against segments our advertisers care about.
            Finally, we use geospatial indexes along with segments to deliver ads
            to devices as they move around the world.

            This page will take you through the process of setting up the demo,
            explaining everything as we go. If you have any questions or issues, please
            file an issue on the [GitHub repo][1] or our [forums][2].

            [1]: https://github.com/singlestore-labs/demo-s2cellular
            [2]: https://www.singlestore.com/forum/
          `})}),i(vo,{columnGap:6,rowGap:10,templateColumns:["minmax(0, 1fr)",null,"repeat(2, minmax(0, 1fr))"],children:m})]})};function ti(){const e=i(P,{height:"100vh",children:i(D,{size:"xl",speed:"0.85s",thickness:"3px",emptyColor:"gray.200",color:"blue.500"})});return i(u.exports.Suspense,{fallback:e,children:c(se,{height:"100vh",direction:"column",children:[i(Rr,{}),i(C,{m:4,flex:"1",children:c(Ct,{children:[i(qe,{path:"/",element:i(oi,{})}),i(qe,{path:"/map",element:i(Yr,{})})]})})]})})}const ri=t=>{var r=t,{children:e}=r,o=L(r,["children"]);return i(zt,f(b({as:"pre",borderRadius:"md",overflow:"auto",display:"block",px:6,py:4,minW:0},o),{children:e}))};class ii extends X.Component{constructor(){super(void 0);_(this,"state",{});this.handlePromiseRejection=this.handlePromiseRejection.bind(this)}componentDidMount(){window.addEventListener("unhandledrejection",this.handlePromiseRejection)}componentWillUnmount(){window.removeEventListener("unhandledrejection",this.handlePromiseRejection)}handlePromiseRejection(o){this.setState({error:o.reason})}static getDerivedStateFromError(o){return{error:o}}render(){const{error:o}=this.state;if(o){let t;return o instanceof O&&(t=c(w,{children:[i(me,{textAlign:"center",children:"An error occurred while running the following query:"}),i(ri,{children:le(o.sql)})]})),i(Me,{maxW:"container.md",my:10,children:c(W,{gap:4,children:[i(P,{children:i(mo,{boxSize:20,color:"red"})}),i(ge,{size:"xl",textAlign:"center",children:o.message}),t,c(ce,{justify:"center",gap:4,children:[i(N,{onClick:()=>this.setState({error:void 0}),size:"sm",children:"Dismiss Error"}),i(N,{onClick:()=>window.location.reload(),size:"sm",colorScheme:"blue",leftIcon:i(xt,{}),children:"Reload"})]})]})})}return this.props.children}}const ai=Dt({fonts:{heading:"InterVariable, sans-serif",body:"InterVariable, sans-serif",mono:'"Source Code ProVariable", monospace'},components:{Link:{baseStyle:e=>({color:e.colorMode==="light"?"blue.600":"blue.300"})}}}),ni=({children:e})=>{const o=lo();return i(Ft,{value:{onError:r=>{o({title:"An error occurred",description:r.message,status:"error",duration:5e3,isClosable:!0})}},children:e})};Pt.render(i(X.StrictMode,{children:i(Mt,{theme:ai,children:i(ii,{children:i(ni,{children:i(Bt,{children:i(Ut,{basename:"/",children:i(ti,{})})})})})})}),document.getElementById("root"));
